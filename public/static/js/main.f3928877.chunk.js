(this.webpackJsonpreact2=this.webpackJsonpreact2||[]).push([[0],{321:function(e,t,n){},348:function(e,t,n){},351:function(e,t,n){},352:function(e,t,n){},353:function(e,t,n){},354:function(e,t,n){},496:function(e,t,n){"use strict";n.r(t);var a=n(40),c=n.n(a),s=n(72),r=n(39),o=n(9),l=(n(321),n(0)),i=n.n(l),d=n(42),u=n.n(d),j=n(306),b=n(115),h=n(504),m=n(276),f=n.n(m),O=(n(348),n(44)),p=n(6),g=function(e){var t=e.logout,n=e.user,a=e.login,c=e.authenticated;return Object(p.jsxs)("div",{className:"header",children:[Object(p.jsx)("div",{children:Object(p.jsx)("p",{children:"GLAM URL Shortener"})}),Object(p.jsx)("div",{className:c?"":"fix-view-div",children:c?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("p",{children:["Welcome ",Object(p.jsx)("span",{className:"header-user-tab",children:n})]}),Object(p.jsx)(O.a,{className:"logout-button",onClick:t,children:"Sign out"})]}):Object(p.jsx)(O.a,{className:"login-button fix-view-button",onClick:a,children:"Sign in with AD"})})]})},x=n(131),v=n.n(x),w=n(278),S=(n(351),n(352),n(151)),k=function(e){var t=e.passwordProtect,n=e.setPasswordProtect,a=e.password,c=e.setPassword,s=e.alias,r=e.setAlias,l=e.expire,d=e.setExpire,j=e.loading,b=e.aliasAllowed,h=e.setAliasAllowed,m=e.passwordError,f=e.aliasError,O=e.passwordTouched,g=e.setPasswordTouched,x=e.setError,v=i.a.useState(s),w=Object(o.a)(v,2),k=w[0],y=w[1],E=i.a.useState("Available"),C=Object(o.a)(E,2),L=C[0],T=C[1];return i.a.useEffect((function(){if(k.length>0){if(k.startsWith("api")||k.startsWith("glamurlshortenerapplication"))return h(!1),void T("Not available");h(!1),T("Checking")}else h(!0);var e=setTimeout((function(){k.length>0?u.a.get("/api/url/short/".concat(k,"/exists")).then((function(e){e.data.exists?(h(!1),T("Not available")):(h(!0),r(k),T("Available"))})).catch((function(e){var t;e.response&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?x(e.response.data.message):x("Something went wrong! :("));r(""),y(""),h(!0),console.log(e)})):(r(""),h(!0))}),1e3);return function(){clearTimeout(e)}}),[k,r,h,x]),Object(p.jsxs)("div",{className:"link-options",children:[Object(p.jsxs)("div",{className:"password-protect",children:[Object(p.jsxs)("label",{className:"container",children:[Object(p.jsx)("div",{className:t?"not-selected":"selected",children:"Public"}),Object(p.jsx)("input",{disabled:j,type:"radio",checked:!t,onChange:function(){c(""),g(!1),n(!1)},name:"radio"}),Object(p.jsx)("span",{className:"checkmark"})]}),Object(p.jsxs)("label",{className:"container",children:[Object(p.jsx)("div",{className:t?"selected":"not-selected",children:"Secret"}),Object(p.jsx)("input",{disabled:j,type:"radio",checked:t,onChange:function(){return n(!0)},name:"radio"}),Object(p.jsx)("span",{className:"checkmark"})]})]}),t?Object(p.jsx)("input",{className:"app-input ".concat(m?"error":""),style:{marginTop:"0px",marginBottom:"1rem"},placeholder:"******** (required if secret is selected)",value:a,onClick:function(){return g(!0)},onChange:function(e){O||g(!0),c(e.target.value)}}):null,Object(p.jsxs)("div",{className:"alias",children:[Object(p.jsx)("label",{children:window.location.href.split("glamurlshortenerapplication")[0]}),Object(p.jsx)("input",{className:"app-input ".concat(f?"error":""),placeholder:"custom alias (optional)",value:k,onChange:function(e){return y(e.target.value)}}),k.length>0?Object(p.jsx)("span",{className:b?"available":"notavailable",children:L}):null]}),Object(p.jsx)("div",{children:Object(p.jsx)(S.a,{checked:l,onChange:function(e){return d(e.target.checked)},style:{fontSize:"16px",marginTop:"1rem"},children:"Auto expire in 7 days"})})]})},y=function(e){var t=e.accessToken,n=e.username,a=e.authenticated,c=e.setError,s=e.mobileMode,r=e.shortURL,i=e.setShortURL,d=Object(l.useState)(!0),j=Object(o.a)(d,2),b=j[0],h=j[1],m=Object(l.useState)(!1),f=Object(o.a)(m,2),g=f[0],x=f[1],S=Object(l.useState)(!1),y=Object(o.a)(S,2),E=y[0],C=y[1],L=Object(l.useState)(""),T=Object(o.a)(L,2),A=T[0],I=T[1],D=Object(l.useState)(!1),N=Object(o.a)(D,2),U=N[0],M=N[1],R=Object(l.useState)(!1),P=Object(o.a)(R,2),Y=P[0],_=P[1],z=Object(l.useState)(""),B=Object(o.a)(z,2),W=B[0],F=B[1],G=Object(l.useState)(""),K=Object(o.a)(G,2),V=K[0],q=K[1],H=Object(l.useState)(!0),J=Object(o.a)(H,2),Q=J[0],X=J[1],Z=Object(l.useState)(!1),$=Object(o.a)(Z,2),ee=$[0],te=$[1],ne=Object(l.useState)(!1),ae=Object(o.a)(ne,2),ce=ae[0],se=ae[1],re=Object(l.useState)(!1),oe=Object(o.a)(re,2),le=oe[0],ie=oe[1],de=Object(l.useState)(!1),ue=Object(o.a)(de,2),je=ue[0],be=ue[1],he=Object(l.useState)(!1),me=Object(o.a)(he,2),fe=me[0],Oe=me[1],pe=Object(l.useState)(!1),ge=Object(o.a)(pe,2),xe=ge[0],ve=ge[1],we=Object(l.useState)("Copy"),Se=Object(o.a)(we,2),ke=Se[0],ye=Se[1],Ee=function(){var e=Object(w.a)(v.a.mark((function e(s){var r,o,l,d,j;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.preventDefault(),a){e.next=4;break}return c("Please login to shorten URL"),e.abrupt("return");case 4:if(!b){e.next=7;break}return Ce(),e.abrupt("return");case 7:return C(!0),x(!0),h(!0),e.prev=10,r={full:A,password:W.length>0?W:void 0,short:V.length>0?V:void 0,accessToken:t,username:n},ee&&(r.state=!0),e.next=15,u()({method:"POST",url:"/api/url/shortUrls",data:r});case 15:201===(o=e.sent).status||200===o.status?(l=o.data.shortUrl.short,ye("Copy"),i(window.location.href.split("glamurlshortenerapplication")[0]+l),I(""),M(!1),_(!1),F(""),q(""),te(!1),X(!0),se(!1),ie(!1),be(!1),Oe(!1),ve(!1)):("shortURL already exists"===(d=o.data.error)?(c("Alias is already in use"),q("")):c(d),h(!1)),C(!1),x(!1),e.next=28;break;case 21:e.prev=21,e.t0=e.catch(10),e.t0.response&&((null===(j=e.t0.response.data)||void 0===j?void 0:j.message)?c(e.t0.response.data.message):c("Something went wrong! :(")),h(!1),C(!1),x(!1),console.log(e.t0);case 28:case"end":return e.stop()}}),e,null,[[10,21]])})));return function(t){return e.apply(this,arguments)}}(),Ce=function(){0===A.length&&be(!0),U&&(Y&&0===W.length&&Oe(!0),V.length>0&&(Q||ve(!0)))};return Object(l.useEffect)((function(){A.length>0&&/(([\w]+:)?\/\/)?(([\d\w]|%[a-fA-f\d]{2,2})+(:([\d\w]|%[a-fA-f\d]{2,2})+)?@)?([\d\w][-\d\w]{0,253}[\d\w]\.)+[\w]{2,63}(:[\d]+)?(\/([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)*(\?(&?([-+_~.\d\w]|%[a-fA-f\d]{2,2})=?)*)?(#([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)?/.test(A)?(be(!1),U?Y?W.length>0&&Q?(Oe(!1),ve(!1),h(!1)):(0===W.length&&le&&Oe(!0),Q||ve(!0),h(!0)):Q?(Oe(!1),ve(!1),h(!1)):(ve(!0),h(!0)):(Oe(!1),ve(!1),h(!1))):(ce&&be(!0),h(!0))}),[A,U,Y,W,Q,le,ce]),Object(l.useEffect)((function(){a||(ye("Copy"),i(null),I(""),M(!1),_(!1),F(""),q(""),X(!0),se(!1),ie(!1),be(!1),Oe(!1),ve(!1))}),[a,i]),Object(l.useEffect)((function(){return function(){return i(null)}}),[i]),Object(p.jsxs)("div",{className:"main",children:[Object(p.jsx)("p",{children:"GLAM URL Shortener"}),r?Object(p.jsxs)("div",{className:"short-url",children:[Object(p.jsx)("span",{style:{marginRight:"0.5rem"},children:"Short URL is "}),Object(p.jsx)("a",{style:{wordBreak:"break-all"},target:"_blank",rel:"noreferrer",href:r,children:s?r.slice(0,30)+"...":r}),Object(p.jsx)("span",{className:"copy-button",onClick:function(){var e=document.createElement("input");document.body.appendChild(e),e.value=r,e.select(),document.execCommand("copy",!1),e.remove(),ye("Copied")},children:ke})]}):null,Object(p.jsx)("div",{className:"loader",style:{display:E?"block":"none"},children:Object(p.jsx)("div",{className:"loading"})}),Object(p.jsxs)("form",{onSubmit:Ee,children:[Object(p.jsx)("input",{className:"url-input ".concat(je?"error":""),placeholder:"http(s)://",value:A,onClick:function(){return se(!0)},onChange:function(e){ce||se(!0),I(e.target.value)}}),U?Object(p.jsx)(k,{passwordProtect:Y,setPasswordProtect:_,password:W,setPassword:F,alias:V,setAlias:q,expire:ee,setExpire:te,loading:E,aliasAllowed:Q,setAliasAllowed:X,passwordError:fe,aliasError:xe,passwordTouched:le,setPasswordTouched:ie,setError:c}):null,Object(p.jsxs)("div",{className:"form-buttons",children:[Object(p.jsx)(O.a,{type:"submit",className:b?"disabled":"",onClick:Ee,children:"Shorten"}),Object(p.jsx)("button",{type:"button",onClick:function(){g||M((function(e){return!e}))},className:g?"disabled":"",children:"Customize"})]})]})]})},E=n(156),C=n(150),L=(n(353),n(149)),T=n(511),A=n(507),I=n(130),D=n(187),N=n(505),U=(n(354),n(508)),M=n(506),R=n(93),P=n(500),Y=n(294),_=n(295),z=n(157),B=n(311),W=n(510),F=n(296),G=n(148),K=n(279),V=function(e){var t=e.isModalVisible,n=e.modalInfo,a=e.setModalInfo,c=e.modalStartDate,i=e.setModalStartDate,d=e.modalEndDate,j=e.setModalEndDate,b=e.setError,h=e.mobileMode,m=e.Admin,f=Object(l.useState)([]),O=Object(o.a)(f,2),g=O[0],x=O[1],v=Object(l.useState)([]),w=Object(o.a)(v,2),S=w[0],k=w[1],y=Object(l.useState)([]),E=Object(o.a)(y,2),C=E[0],L=E[1],T=Object(l.useState)([]),A=Object(o.a)(T,2),I=A[0],D=A[1],N=Object(r.g)();return Object(l.useEffect)((function(){var e=function(){N.push("/glamurlshortenerapplication/".concat(m?"admin":"links"))};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[a,j,i,N,m]),Object(l.useEffect)((function(){n&&u.a.get("/api/url/short/clickDates/".concat(n.short)).then((function(e){var t=e.data.shortUrl.clicksDates;return x(t)})).catch((function(e){b("Something went wrong :("),console.log(e)}))}),[n,b]),Object(l.useEffect)((function(){if(g.length>0){var e={},t={},n={};g.forEach((function(a){var s=a.date,r=a.referrer,o=a.location,l=("00"+(s=new Date(s)).getDate()).slice(-2)+"/"+("00"+(s.getMonth()+1)).slice(-2)+"/"+s.getFullYear(),i=function(a,c){e[a]?e[a]=e[a]+1:e[a]=1,t[c]?t[c]=t[c]+1:t[c]=1,n[o]?n[o]=n[o]+1:n[o]=1};if(c&&d){var u=c.format("DD/MM/YYYY"),j=d.format("DD/MM/YYYY");l>=u&&l<=j&&i(l,r)}else if(c){l>=c.format("DD/MM/YYYY")&&i(l,r)}else if(d){l<=d.format("DD/MM/YYYY")&&i(l,r)}else i(l,r)}));var a=[],s=[],r=[];Object.keys(e).forEach((function(t){a.push({date:t,clicks:e[t]})})),a=a.sort(),Object.keys(t).forEach((function(e){return s.push({name:e,value:t[e]})})),Object.keys(n).forEach((function(e){r.push({country:e,value:n[e]})}));o=s,l=r,k(a),L(o),D(l)}var o,l}),[g,c,d]),Object(p.jsxs)(U.a,{title:"Clicks Stats".concat(h?"":" (Press any key to close modal)"),visible:t,footer:null,closeIcon:Object(p.jsx)(s.b,{to:"/glamurlshortenerapplication/".concat(m?"admin":"links"),children:"\u2716"}),children:[Object(p.jsxs)("div",{className:"modal-top-half",children:[Object(p.jsxs)("div",{className:"links",children:[Object(p.jsxs)("p",{children:["Short Link :"," ",Object(p.jsx)("a",{target:"_blank",rel:"noreferrer",href:window.location.href.split("glamurlshortenerapplication")[0]+(null===n||void 0===n?void 0:n.short),children:null===n||void 0===n?void 0:n.short})]}),Object(p.jsxs)("p",{children:["Long Link :"," ",Object(p.jsx)("a",{target:"_blank",rel:"noreferrer",href:null===n||void 0===n?void 0:n.full,children:(null===n||void 0===n?void 0:n.full.slice(0,h?40:50))+"..."})]})]}),Object(p.jsxs)("div",{className:"dates",children:[Object(p.jsx)(M.a,{placeholder:"Start date",onChange:i,disabledDate:function(e){return d&&e>d||e>Date.now()},value:c,style:{marginBottom:"1rem"}}),Object(p.jsx)(M.a,{placeholder:"End date",onChange:j,disabledDate:function(e){return c?e>Date.now()||e<c:e>Date.now()},value:d})]})]}),g.length>0?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{className:"modal-bottom-half",children:[Object(p.jsxs)("div",{children:[Object(p.jsx)("h3",{className:"graph-label",children:"Traffic over time"}),Object(p.jsxs)(P.a,{width:h?350:500,height:280,data:S,children:[Object(p.jsx)(Y.a,{dataKey:"date"}),Object(p.jsx)(_.a,{dataKey:"clicks"}),Object(p.jsx)(z.a,{}),Object(p.jsx)(B.a,{dataKey:"clicks",fill:"#3E3F3A"})]})]}),Object(p.jsxs)("div",{children:[Object(p.jsx)("h3",{className:"graph-label",children:"Traffic sources"}),Object(p.jsxs)(W.a,{width:400,height:250,children:[Object(p.jsx)(F.a,{data:C,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,fill:"#3E3F3A"}),Object(p.jsx)(G.a,{}),Object(p.jsx)(z.a,{})]})]})]}),Object(p.jsx)("div",{className:"modal-world-map",children:I.length>0?Object(p.jsx)(K.WorldMap,{color:"#3E3F3A",title:"Traffic sources categorized by countries",size:"xl",data:I,frame:!0}):Object(p.jsx)(R.a,{style:{marginTop:"2rem"}})})]}):Object(p.jsx)(R.a,{style:{marginTop:"2rem"}})]})},q=function(e){var t=e.isModalVisible,n=e.setIsModalVisible,a=e.modalInfo,c=e.setError,s=e.urls,r=e.setUrls,l=e.accessToken,d=e.username,b=i.a.useState(!1),h=Object(o.a)(b,2),m=h[0],f=h[1],O=i.a.useState(a?a.full:""),g=Object(o.a)(O,2),x=g[0],v=g[1];return i.a.useEffect((function(){a&&v(a.full)}),[a]),Object(p.jsx)(U.a,{title:"Edit Long URL",okText:"Save",visible:t,closeIcon:Object(p.jsx)("h2",{onClick:function(){return n(!1)},children:"\u2716"}),confirmLoading:m,onOk:function(){x.length>0&&/(([\w]+:)?\/\/)?(([\d\w]|%[a-fA-f\d]{2,2})+(:([\d\w]|%[a-fA-f\d]{2,2})+)?@)?([\d\w][-\d\w]{0,253}[\d\w]\.)+[\w]{2,63}(:[\d]+)?(\/([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)*(\?(&?([-+_~.\d\w]|%[a-fA-f\d]{2,2})=?)*)?(#([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)?/.test(x)?(f(!0),u.a.patch("/api/url/shortUrls/long",{full:x,accessToken:l,username:d,id:null===a||void 0===a?void 0:a.key}).then((function(e){if(200===e.status){var t=Object(C.a)(s);t[null===a||void 0===a?void 0:a.idx].full=x,o="Saved",j.b.success(o),r(t),f(!1),n(!1)}else c("Something went wrong! :(");var o})).catch((function(e){var t;(console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?c(e.response.data.message):c("Something went wrong! :("))}))):(c("Invalid URL entered"),f(!1),n(!1))},onCancel:function(){return n(!1)},children:Object(p.jsxs)("div",{style:{width:"90%",display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(p.jsxs)("p",{style:{fontWeight:"900",textAlign:"center"},children:["Short URL :",Object(p.jsx)("span",{style:{marginLeft:"1rem",fontWeight:"400"},children:null===a||void 0===a?void 0:a.short})]}),Object(p.jsxs)("p",{style:{fontWeight:"900",textAlign:"center"},children:["Long URL :",Object(p.jsx)("input",{value:x,onChange:function(e){return v(e.target.value)},style:{border:"none",outline:"none",marginLeft:"1rem",width:"60vw",fontWeight:"400",marginTop:"1rem"}})]})]})})},H=L.a.Option,J=function(e){j.b.success(e)},Q=function(e){var t=e.username,n=e.accessToken,a=e.setError,c=e.mobileMode,i=e.Admin,d=Object(l.useState)([{short:"asdasdasdas",full:"https://stackoverflow.com/teams",clicks:10}]),j=Object(o.a)(d,2),b=j[0],h=j[1],m=Object(l.useState)(!1),f=Object(o.a)(m,2),g=f[0],x=f[1],v=Object(l.useState)(!1),w=Object(o.a)(v,2),S=w[0],k=w[1],y=Object(l.useState)(0),U=Object(o.a)(y,2),M=U[0],R=U[1],P=Object(l.useState)([]),Y=Object(o.a)(P,2),_=Y[0],z=Y[1],B=Object(l.useState)(!1),W=Object(o.a)(B,2),F=W[0],G=W[1],K=Object(l.useState)(!1),Q=Object(o.a)(K,2),X=Q[0],Z=Q[1],$=Object(l.useState)(!1),ee=Object(o.a)($,2),te=ee[0],ne=ee[1],ae=Object(l.useState)(!1),ce=Object(o.a)(ae,2),se=ce[0],re=ce[1],oe=Object(l.useState)(!1),le=Object(o.a)(oe,2),ie=le[0],de=le[1],ue=Object(l.useState)(!1),je=Object(o.a)(ue,2),be=je[0],he=je[1],me=Object(l.useState)(!1),fe=Object(o.a)(me,2),Oe=fe[0],pe=fe[1],ge=Object(l.useState)(""),xe=Object(o.a)(ge,2),ve=xe[0],we=xe[1],Se=Object(l.useState)(""),ke=Object(o.a)(Se,2),ye=ke[0],Ee=ke[1],Ce=Object(l.useState)(1),Le=Object(o.a)(Ce,2),Te=Le[0],Ae=Le[1],Ie=Object(l.useState)(10),De=Object(o.a)(Ie,2),Ne=De[0],Ue=De[1],Me=Object(l.useState)("latest"),Re=Object(o.a)(Me,2),Pe=Re[0],Ye=Re[1],_e=Object(l.useState)(3),ze=Object(o.a)(_e,2),Be=ze[0],We=ze[1],Fe=Object(l.useState)(null),Ge=Object(o.a)(Fe,2),Ke=Ge[0],Ve=Ge[1],qe=Object(l.useState)(null),He=Object(o.a)(qe,2),Je=He[0],Qe=He[1],Xe=Object(l.useState)(null),Ze=Object(o.a)(Xe,2),$e=Ze[0],et=Ze[1],tt=Object(l.useState)(!1),nt=Object(o.a)(tt,2),at=nt[0],ct=nt[1],st=Object(l.useState)(!1),rt=Object(o.a)(st,2),ot=rt[0],lt=rt[1],it=Object(l.useState)(null),dt=Object(o.a)(it,2),ut=dt[0],jt=dt[1],bt=Object(r.i)().url,ht=Object(r.h)(),mt=ht.short,ft=ht.full,Ot=[{title:"Created at",dataIndex:"createdAt",render:function(e){var t=new Date(e);return Object(p.jsx)("p",{children:("00"+(t.getMonth()+1)).slice(-2)+"/"+("00"+t.getDate()).slice(-2)+"/"+t.getFullYear()+" "+("00"+t.getHours()).slice(-2)+":"+("00"+t.getMinutes()).slice(-2)+":"+("00"+t.getSeconds()).slice(-2)})}},{title:"Short URL",dataIndex:"short",render:function(e,t){var n=t.idx;return Object(p.jsxs)("p",{children:[Object(p.jsx)("a",{target:"_blank",rel:"noreferrer",onClick:function(){var e=Object(C.a)(b);e[n]=Object(E.a)(Object(E.a)({},e[n]),{},{clicks:e[n].clicks+1}),h(e)},href:window.location.href.split("glamurlshortenerapplication")[0]+e,children:e}),Object(p.jsx)("span",{className:"copy-button-list",onClick:function(){var t=document.createElement("input");document.body.appendChild(t),t.value=window.location.href.split("glamurlshortenerapplication")[0]+e,t.select(),document.execCommand("copy",!1),t.remove(),J("Copied")},children:"Copy"})]})}},{title:"Long URL",dataIndex:"full",render:function(e,t){var n=t.idx,a=t.key,c=t.short;return Object(p.jsxs)("p",{children:[Object(p.jsx)("a",{target:"_blank",rel:"noreferrer",href:e,children:e.slice(0,50)+"..."}),Object(p.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"18px",cursor:"pointer"},onClick:function(){jt({key:a,idx:n,full:e,short:c}),lt(!0)},children:"\u270e"})]})}},{title:"Clicks",dataIndex:"clicks",render:function(e,t){var n=t.short,a=t.full;return Object(p.jsxs)(s.b,{to:"".concat(bt,"/").concat(n,"/").concat(a.replace(/\//g,"-")),children:[e," \ud83d\udcc8"]})}},{title:"Protected",dataIndex:"password",render:function(e){return e?Object(p.jsx)("p",{style:{cursor:"pointer"},onClick:function(){return k((function(e){return!e}))},children:S?e:Object(p.jsx)("span",{children:"\ud83d\udd12"})}):Object(p.jsx)("h3",{children:"--"})}},{title:"Status",dataIndex:"status",render:function(e){return e?Object(p.jsx)("p",{children:"Enabled"}):Object(p.jsx)("p",{children:"Disabled"})}}];i&&Ot.splice(1,0,{title:"Created By",dataIndex:"user"}),Object(l.useEffect)((function(){Ae(1),z([])}),[i]),Object(l.useEffect)((function(){mt&&ft?(Ve({short:mt,full:ft.replace(/-/g,"/")}),Qe(null),et(null)):(Ve(null),Qe(null),et(null))}),[mt,ft]),Object(l.useEffect)((function(){var e=i?"/api/url/admin":"/api/url";u.a.post(e,{accessToken:n,username:t,pageNumber:Te,search:ve,sort:Pe,filter:Be,pageSize:Ne}).then((function(e){var n=[];e.data.shortUrls.forEach((function(e,t){var a=e.short,c=e.full,s=e.clicks,r=e._id,o=e.password,l=e.createdAt,i=e.status,d=e.user;n.push({short:a,full:c,clicks:s,key:r,password:o,createdAt:l,status:i,idx:t,user:d})})),h(n);var c=i?"/api/url/admin/shortUrls/count/".concat(t):"/api/url/shortUrls/count/".concat(t);u.a.get(c).then((function(e){var t=e.data.count;return R(t)})).catch((function(e){var t;(console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?a(e.response.data.message):a("Something went wrong! :("))}))})).catch((function(e){var t;(console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?a(e.response.data.message):a("Something went wrong! :("))}))}),[t,n,a,Te,ve,Be,Pe,g,Ne,i]),Object(l.useEffect)((function(){var e=setTimeout((function(){we(ye),Ae(1)}),1e3);return function(){return clearTimeout(e)}}),[ye]),Object(l.useEffect)((function(){ct(!!Ke)}),[Ke]);var pt=function(e){de(!0),e?(he(!0),re(!0)):(pe(!0),ne(!0));var c=[];_.forEach((function(t){b.find((function(e){return e.key===t})).status!==e&&c.push(t)})),u.a.patch("/api/url/shortUrls",{accessToken:n,username:t,ids:c,status:e}).then((function(){J(e?"Enabled":"Disabled"),ne(!1),de(!1),z([]),e?(he(!1),re(!1)):(pe(!1),ne(!1));var t=Object(C.a)(b);t=t.map((function(t){return c.some((function(e){return t.key===e}))?Object(E.a)(Object(E.a)({},t),{},{status:e}):t})),h(t)})).catch((function(t){var n;(z([]),ne(!1),de(!1),e?(he(!1),re(!1)):(pe(!1),ne(!1)),console.log(t),t.response)&&((null===(n=t.response.data)||void 0===n?void 0:n.message)?a(t.response.data.message):a("Something went wrong! :("))}))},gt={selectedRows:_,onChange:function(e){return z(e)}},xt=_.length>0;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(V,{isModalVisible:at,modalInfo:Ke,setModalInfo:Ve,modalStartDate:Je,setModalStartDate:Qe,modalEndDate:$e,setModalEndDate:et,setError:a,mobileMode:c,Admin:i}),Object(p.jsx)(q,{isModalVisible:ot,setIsModalVisible:lt,modalInfo:ut,setError:a,urls:b,setUrls:h,accessToken:n,username:t}),Object(p.jsxs)("div",{className:"list-container",children:[Object(p.jsxs)("p",{children:["Table of links generated by ",i?"others":"you"]}),Object(p.jsxs)("div",{children:[Object(p.jsxs)("div",{style:{marginBottom:"1rem"},children:[Object(p.jsx)(T.a,{title:"Are you sure to delete selected URLs?",onCancel:function(){G(!0),he(!0),pe(!0);var e=[];_.forEach((function(t){e.push(t)})),u.a.delete("/api/url/shortUrls",{data:{accessToken:n,username:t,ids:e}}).then((function(){J("Deleted"),G(!1),he(!1),pe(!1),Ae(1),z([]),x((function(e){return!e}))})).catch((function(e){var t;(z([]),G(!1),he(!1),pe(!1),x((function(e){return!e})),console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?a(e.response.data.message):a("Something went wrong! :("))}))},okText:"Cancel",cancelText:"Delete",children:Object(p.jsx)(O.a,{style:{marginRight:"0.5rem"},type:"danger",disabled:!xt||ie,loading:F,children:"Delete"})}),"  ",Object(p.jsx)(T.a,{title:"Are you sure to disable selected URLs?",onCancel:function(){return pt(!1)},okText:"Cancel",cancelText:"Disable",children:Object(p.jsx)(O.a,{style:{marginLeft:"0.5rem",marginRight:"0.5rem"},type:"danger",disabled:!xt||be,loading:te,children:"Disable"})}),"  ",Object(p.jsx)(T.a,{title:"Are you sure to enable selected URLs?",onCancel:function(){return pt(!0)},okText:"Cancel",cancelText:"Enable",children:Object(p.jsx)(O.a,{style:{marginLeft:"0.5rem"},type:"primary",disabled:!xt||Oe,loading:se,children:"Enable"})}),Object(p.jsx)("span",{style:{marginLeft:8,position:"relative",top:"5px"},children:xt?"Selected ".concat(_.length," items"):""})]}),Object(p.jsx)("div",{children:Object(p.jsx)(A.a,{placeholder:"Search....",value:ye,onChange:function(e){return Ee(e.target.value)}})}),Object(p.jsxs)("div",{children:[Object(p.jsx)(I.a,{title:"Sort by",children:Object(p.jsxs)(L.a,{value:Pe,onChange:function(e){Ae(1),Ye(e)},children:[Object(p.jsx)(H,{value:"latest",children:"Latest"}),Object(p.jsx)(H,{value:"oldest",children:"Oldest"}),Object(p.jsx)(H,{value:"mostclicked",children:"Most clicked"}),Object(p.jsx)(H,{value:"leastclicked",children:"Least clicked"})]})}),Object(p.jsx)(I.a,{title:"Link enabled/disabled filter",children:Object(p.jsxs)(D.a.Group,{onChange:function(e){Ae(1),We(e.target.value)},value:Be,children:[Object(p.jsx)(D.a,{value:1,children:"Enabled"}),Object(p.jsx)(D.a,{value:2,children:"Disabled"}),Object(p.jsx)(D.a,{value:3,children:"Both"})]})})]}),Object(p.jsx)(O.a,{type:"primary",disabled:1===Te&&10===Ne&&"latest"===Pe&&3===Be,onClick:function(){Ae(1),Ue(10),Ye("latest"),We(3)},children:"Reset defaults"})]}),Object(p.jsx)(N.a,{rowSelection:gt,columns:Ot,dataSource:b,scroll:{x:1e3},pagination:{current:Te,total:M,onChange:Ae,position:["topRight"],onShowSizeChange:Ue}}),M>0?Object(p.jsx)(T.a,{title:"Are you sure to delete all URLs generated by you?",onCancel:function(){Z(!0);var e=i?"/api/url/admin/shortUrls/all":"/api/url/shortUrls/all";u.a.delete(e,{data:{accessToken:n,username:t}}).then((function(){h([]),R(0),G(!1),Ae(1),x((function(e){return!e}))})).catch((function(e){var t;(Z(!1),console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?a(e.response.data.message):a("Something went wrong! :("))}))},okText:"Cancel",cancelText:"Delete",children:Object(p.jsxs)(O.a,{style:{margin:"1rem 0"},type:"danger",loading:X,children:["Delete all ",M," links generated by"," ",i?"other users":"you"]})}):null]})]})},X={appId:"130be11a-3569-49d1-a34e-8f5ea8d71e65",redirectUri:window.location.href.split("glamurlshortenerapplication")[0],scopes:["user.read"],authority:"https://login.microsoftonline.com/".concat("7c3e4bc5-2339-4622-8feb-47d86d4b5c90")},Z=Object(r.j)((function(e){var t=e.location,n=null,a=Object(l.useState)("home"),c=Object(o.a)(a,2),i=c[0],d=c[1],m=Object(l.useState)(!1),O=Object(o.a)(m,2),x=O[0],v=O[1],w=Object(l.useState)(!1),S=Object(o.a)(w,2),k=S[0],E=S[1],C=Object(l.useState)(!1),L=Object(o.a)(C,2),T=L[0],A=L[1],I=Object(l.useState)(!1),D=Object(o.a)(I,2),N=D[0],U=D[1],M=Object(l.useState)(null),R=Object(o.a)(M,2),P=R[0],Y=R[1],_=Object(l.useState)(null),z=Object(o.a)(_,2),B=z[0],W=z[1],F=Object(l.useState)(null),G=Object(o.a)(F,2),K=G[0],V=G[1],q=Object(l.useState)(null),H=Object(o.a)(q,2),J=H[0],Z=H[1],$=Object(l.useState)(null),ee=Object(o.a)($,2),te=ee[0],ne=ee[1],ae=Object(r.i)(),ce=ae.path,se=ae.url,re=Object(r.g)();Object(l.useEffect)((function(){var e=t.pathname.split("/");2===e.length?d("home"):"about"===e[2]?d("about"):"links"===e[2]?d("links"):"admin"===e[2]?d("admin"):d("home")}),[t]),Object(l.useEffect)((function(){localStorage.getItem("redirect")?t.pathname.length>28&&localStorage.setItem("redirect",t.pathname):localStorage.setItem("redirect",t.pathname),window.innerWidth<768?U(!0):U(!1);var e=window.addEventListener("resize",(function(){window.innerWidth<768?U(!0):U(!1)})),n=localStorage.getItem("accesstoken"),a=localStorage.getItem("username"),c=localStorage.getItem("name");return n&&a&&c&&!k&&u.a.post("/api/authenticate",{accessToken:n,username:a}).then((function(e){if(200===e.status){v(!0),e.data.admin&&A(!0),Y(c),W(n),V(a),E(!0);var t=localStorage.getItem("redirect");t&&(re.push(t),localStorage.removeItem("redirect"))}else Z("Something went wrong! :(")})).catch((function(e){var t,n;e.response&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?Z(e.response.data.message):e.response&&((null===(n=e.response.data)||void 0===n?void 0:n.message)?Z(e.response.data.message):Z("Something went wrong! :(")));console.log(e)})),function(){window.removeEventListener("resize",e)}}),[x,t,k,re]),Object(l.useEffect)((function(){var e;J&&(e=J,j.b.error(e),Z(null))}),[J]);var oe=new h.a({auth:{clientId:X.appId,redirectUri:X.redirectUri,authority:X.authority}}),le=function(){try{oe.logoutPopup().then((function(){localStorage.removeItem("name"),localStorage.removeItem("accesstoken"),localStorage.removeItem("username"),localStorage.removeItem("redirect"),clearTimeout(n),Y(null),v(!1),E(!1),A(!1),W(null),V(null),ne(null),d("home")}))}catch(t){var e;if(console.log(t),t.response)(null===(e=t.response.data)||void 0===e?void 0:e.message)?Z(t.response.data.message):Z("Something went wrong! :(")}};return Object(p.jsx)("div",{children:Object(p.jsxs)("div",{children:[Object(p.jsx)(g,{user:P,authenticated:x,login:function(){try{oe.loginPopup({scopes:X.scopes,prompt:"select_account"}).then((function(e){console.log(e),n=setTimeout(le,3599998),localStorage.setItem("name",e.account.name),localStorage.setItem("username",e.account.username),localStorage.setItem("accesstoken",e.idToken),v(!0)}))}catch(t){var e;if(console.log(t),t.response)(null===(e=t.response.data)||void 0===e?void 0:e.message)?Z(t.response.data.message):Z("Something went wrong! :(")}},logout:le}),Object(p.jsx)("div",{className:"menu-container",children:Object(p.jsxs)(b.a,{onClick:function(e){return d(e.key)},selectedKeys:[i],mode:"horizontal",style:{justifyContent:"center",width:"100%"},theme:"dark",children:[Object(p.jsx)(b.a.Item,{children:Object(p.jsx)(s.b,{to:se,children:"Home"})},"home"),Object(p.jsx)(b.a.Item,{children:Object(p.jsx)(s.b,{to:"".concat(se,"/about"),children:"About"})},"about"),x?Object(p.jsx)(b.a.Item,{children:Object(p.jsx)(s.b,{to:"".concat(se,"/links"),children:"Links"})},"links"):null,T?Object(p.jsx)(b.a.Item,{children:Object(p.jsx)(s.b,{to:"".concat(se,"/admin"),children:"Admin"})},"admin"):null]})}),Object(p.jsxs)(r.d,{children:[Object(p.jsx)(r.b,{exact:!0,path:ce,children:Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(y,{authenticated:x,accessToken:B,username:K,setError:Z,mobileMode:N,shortURL:te,setShortURL:ne}),te?Object(p.jsx)(f.a,{className:"qr-code-app",value:te}):null]})}),Object(p.jsx)(r.b,{exact:!0,path:"".concat(ce,"/about"),children:Object(p.jsxs)("div",{className:"app-about",children:["GLAM URL shortener is a minimalistic link shortening platform built specifically for Oxford GLAM by",Object(p.jsxs)("a",{target:"_blank",rel:"noreferrer",href:"https://www.cloudmantra.net",children:[" cloudmantra.net",Object(p.jsx)("sup",{children:"TM"})]})]})}),Object(p.jsx)(r.b,{path:"".concat(ce,"/links/:short?/:full?"),children:x?Object(p.jsx)(Q,{accessToken:B,username:K,setError:Z,mobileMode:N}):Object(p.jsx)(r.a,{to:ce})}),Object(p.jsx)(r.b,{path:"".concat(ce,"/admin/:short?/:full?"),children:x?T?Object(p.jsx)(Q,{accessToken:B,username:K,setError:Z,mobileMode:N,Admin:!0}):Object(p.jsx)(r.a,{to:"".concat(ce,"/links")}):Object(p.jsx)(r.a,{to:ce})})]})]})})})),$=function(){var e=Object(l.useState)("Redirecting..."),t=Object(o.a)(e,2),n=t[0],a=t[1],c=Object(l.useState)(!1),s=Object(o.a)(c,2),r=s[0],i=s[1],d=Object(l.useState)(""),j=Object(o.a)(d,2),b=j[0],h=j[1];Object(l.useEffect)((function(){u.a.get("https://freegeoip.app/json/".concat(document.getElementById("gfg").innerText)).then((function(e){u.a.get("/api/url/short/".concat(window.location.pathname.slice(1),"?referrer=").concat(document.referrer,"&location=").concat(e.country_code)).then((function(e){var t=e.data.shortUrl;"string"===typeof t&&"password protected"===t?i(!0):"string"===typeof t&&"disabled"===t?a("Link Disabled"):window.location.href=t.full})).catch((function(e){var t;(console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?a(e.response.data.message):a("Something went wrong! :("))}))})).catch((function(e){a("Something went wrong! :("),console.log(e)}))}),[]);var m=function(e){var t=function(){u.a.get("https://freegeoip.app/json/".concat(document.getElementById("gfg").innerText)).then((function(e){u()({method:"POST",url:"/api/url/short/".concat(window.location.pathname.slice(1),"?referrer=").concat(document.referrer,"&location=").concat(e.country_code),data:{password:b}}).then((function(e){var t=e.data.shortUrl;window.location.href=t.full})).catch((function(e){var t;(console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?a(e.response.data.message):a("Something went wrong! :("))}))})).catch((function(e){a("Something went wrong! :("),console.log(e)}))};"Enter"===e.key?t():e.key||t()};return Object(p.jsxs)("div",{style:{width:"100vw",height:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[r?Object(p.jsx)("p",{style:{fontSize:"5vw",marginBottom:"2rem",color:"white",width:"90vw",height:"100px",backgroundColor:"rgb(62, 63, 58)",display:"flex",justifyContent:"center",alignItems:"center"},children:"GLAM URL Shortener"}):null,Object(p.jsx)("h1",{style:{marginBottom:"2rem",color:"rgb(62, 63, 58)"},children:n}),r?Object(p.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(p.jsx)("input",{style:{padding:"1rem 2rem",textAlign:"center",fontSize:"1rem"},placeholder:"Enter Password",value:b,onChange:function(e){var t=e.target.value;return h(t)},onKeyPress:m}),Object(p.jsx)(O.a,{type:"primary",style:{backgroundColor:"#29abe0",marginLeft:"1rem",width:"80px",height:"50px"},onClick:m,children:"Go"})]}):null]})};c.a.render(Object(p.jsx)(s.a,{children:Object(p.jsxs)(r.d,{children:[Object(p.jsx)(r.b,{exact:!0,path:"/",children:Object(p.jsx)(r.a,{to:"/glamurlshortenerapplication"})}),Object(p.jsx)(r.b,{path:"/glamurlshortenerapplication",component:Z}),Object(p.jsx)(r.b,{path:"/:shortUrl",component:$})]})}),document.getElementById("root"))}},[[496,1,2]]]);
//# sourceMappingURL=main.f3928877.chunk.js.map