(this.webpackJsonpreact2=this.webpackJsonpreact2||[]).push([[0],{320:function(e,t,a){},347:function(e,t,a){},350:function(e,t,a){},351:function(e,t,a){},352:function(e,t,a){},353:function(e,t,a){},495:function(e,t,a){"use strict";a.r(t);var n=a(40),s=a.n(n),c=a(113),r=a(39),o=a(9),l=(a(320),a(0)),i=a.n(l),d=a(43),u=a.n(d),j=a(305),b=a(114),h=a(503),O=a(275),m=a.n(O),f=(a(347),a(44)),p=a(6),g=function(e){var t=e.logout,a=e.user,n=e.login,s=e.authenticated,c=e.authenticationButtonLoading;return Object(p.jsxs)("div",{className:"header",children:[Object(p.jsx)("div",{children:Object(p.jsx)("p",{children:"GLAM URL Shortener"})}),Object(p.jsx)("div",{className:s?"":"fix-view-div",children:s?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("p",{children:["Welcome ",Object(p.jsx)("span",{className:"header-user-tab",children:a})]}),Object(p.jsx)(f.a,{className:"logout-button",onClick:t,loading:c,children:"Sign out"})]}):Object(p.jsx)(f.a,{className:"login-button fix-view-button",onClick:n,loading:c,children:"Sign in with AD"})})]})},x=a(130),v=a.n(x),w=a(277),S=(a(350),a(351),function(e){var t=e.passwordProtect,a=e.setPasswordProtect,n=e.password,s=e.setPassword,c=e.alias,r=e.setAlias,l=e.loading,d=e.aliasAllowed,j=e.setAliasAllowed,b=e.passwordError,h=e.aliasError,O=e.passwordTouched,m=e.setPasswordTouched,f=e.setError,g=i.a.useState(c),x=Object(o.a)(g,2),v=x[0],w=x[1],S=i.a.useState("Available"),k=Object(o.a)(S,2),y=k[0],C=k[1];return i.a.useEffect((function(){if(v.length>0){if(v.startsWith("api"))return j(!1),void C("Not available");j(!1),C("Checking")}else j(!0);var e=setTimeout((function(){v.length>0?u.a.get("/api/url/short/".concat(v,"/exists")).then((function(e){e.data.exists?(j(!1),C("Not available")):(j(!0),r(v),C("Available"))})).catch((function(e){var t;e.response&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?f(e.response.data.message):f("Something went wrong! :("));r(""),w(""),j(!0),console.log(e)})):(r(""),j(!0))}),1e3);return function(){clearTimeout(e)}}),[v,r,j,f]),Object(p.jsxs)("div",{className:"link-options",children:[Object(p.jsx)("p",{children:"Customize link"}),Object(p.jsxs)("div",{className:"password-protect",children:[Object(p.jsxs)("label",{className:"container",children:[Object(p.jsx)("div",{className:t?"not-selected":"selected",children:"Public"}),Object(p.jsx)("input",{disabled:l,type:"radio",checked:!t,onChange:function(){s(""),m(!1),a(!1)},name:"radio"}),Object(p.jsx)("span",{className:"checkmark"})]}),Object(p.jsxs)("label",{className:"container",children:[Object(p.jsx)("div",{className:t?"selected":"not-selected",children:"Secret"}),Object(p.jsx)("input",{disabled:l,type:"radio",checked:t,onChange:function(){return a(!0)},name:"radio"}),Object(p.jsx)("span",{className:"checkmark"})]})]}),t?Object(p.jsx)("input",{className:"app-input ".concat(b?"error":""),style:{marginTop:"0px"},placeholder:"******** (required if secret is selected)",value:n,onClick:function(){return m(!0)},onChange:function(e){O||m(!0),s(e.target.value)}}):null,Object(p.jsxs)("div",{className:"alias",children:[Object(p.jsx)("label",{children:window.location.href.split("glamurlshortenerapplication")[0]}),Object(p.jsx)("input",{className:"app-input ".concat(h?"error":""),placeholder:"custom alias (optional)",value:v,onChange:function(e){return w(e.target.value)}}),v.length>0?Object(p.jsx)("span",{className:d?"available":"notavailable",children:y}):null]})]})}),k=function(e){var t=e.accessToken,a=e.username,n=e.authenticated,s=e.setError,c=e.mobileMode,r=e.shortURL,i=e.setShortURL,d=Object(l.useState)(!0),j=Object(o.a)(d,2),b=j[0],h=j[1],O=Object(l.useState)(!1),m=Object(o.a)(O,2),g=m[0],x=m[1],k=Object(l.useState)(!1),y=Object(o.a)(k,2),C=y[0],E=y[1],L=Object(l.useState)(""),A=Object(o.a)(L,2),T=A[0],I=A[1],D=Object(l.useState)(!1),N=Object(o.a)(D,2),U=N[0],M=N[1],R=Object(l.useState)(!1),P=Object(o.a)(R,2),Y=P[0],_=P[1],z=Object(l.useState)(""),B=Object(o.a)(z,2),F=B[0],W=B[1],V=Object(l.useState)(""),G=Object(o.a)(V,2),K=G[0],q=G[1],H=Object(l.useState)(!0),J=Object(o.a)(H,2),Q=J[0],X=J[1],Z=Object(l.useState)(!1),$=Object(o.a)(Z,2),ee=$[0],te=$[1],ae=Object(l.useState)(!1),ne=Object(o.a)(ae,2),se=ne[0],ce=ne[1],re=Object(l.useState)(!1),oe=Object(o.a)(re,2),le=oe[0],ie=oe[1],de=Object(l.useState)(!1),ue=Object(o.a)(de,2),je=ue[0],be=ue[1],he=Object(l.useState)(!1),Oe=Object(o.a)(he,2),me=Oe[0],fe=Oe[1],pe=Object(l.useState)("Copy"),ge=Object(o.a)(pe,2),xe=ge[0],ve=ge[1],we=function(){var e=Object(w.a)(v.a.mark((function e(c){var r,o,l,d;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.preventDefault(),n){e.next=4;break}return s("Please login to shorten URL"),e.abrupt("return");case 4:if(!b){e.next=7;break}return Se(),e.abrupt("return");case 7:return E(!0),x(!0),h(!0),e.prev=10,e.next=13,u()({method:"POST",url:"/api/url/shortUrls",data:{full:T,password:F.length>0?F:void 0,short:K.length>0?K:void 0,accessToken:t,username:a}});case 13:201===(r=e.sent).status||200===r.status?(o=r.data.shortUrl.short,ve("Copy"),i(window.location.href.split("glamurlshortenerapplication")[0]+o),I(""),M(!1),_(!1),W(""),q(""),X(!0),te(!1),ce(!1),ie(!1),be(!1),fe(!1)):("shortURL already exists"===(l=r.data.error)?(s("Alias is already in use"),q("")):s(l),h(!1)),E(!1),x(!1),e.next=26;break;case 19:e.prev=19,e.t0=e.catch(10),e.t0.response&&((null===(d=e.t0.response.data)||void 0===d?void 0:d.message)?s(e.t0.response.data.message):s("Something went wrong! :(")),h(!1),E(!1),x(!1),console.log(e.t0);case 26:case"end":return e.stop()}}),e,null,[[10,19]])})));return function(t){return e.apply(this,arguments)}}(),Se=function(){0===T.length&&ie(!0),U&&(Y&&0===F.length&&be(!0),K.length>0&&(Q||fe(!0)))};return Object(l.useEffect)((function(){T.length>0&&/(([\w]+:)?\/\/)?(([\d\w]|%[a-fA-f\d]{2,2})+(:([\d\w]|%[a-fA-f\d]{2,2})+)?@)?([\d\w][-\d\w]{0,253}[\d\w]\.)+[\w]{2,63}(:[\d]+)?(\/([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)*(\?(&?([-+_~.\d\w]|%[a-fA-f\d]{2,2})=?)*)?(#([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)?/.test(T)?(ie(!1),U?Y?F.length>0&&Q?(be(!1),fe(!1),h(!1)):(0===F.length&&se&&be(!0),Q||fe(!0),h(!0)):Q?(be(!1),fe(!1),h(!1)):(fe(!0),h(!0)):(be(!1),fe(!1),h(!1))):(ee&&ie(!0),h(!0))}),[T,U,Y,F,Q,se,ee]),Object(l.useEffect)((function(){n||(ve("Copy"),i(null),I(""),M(!1),_(!1),W(""),q(""),X(!0),te(!1),ce(!1),ie(!1),be(!1),fe(!1))}),[n,i]),Object(l.useEffect)((function(){return function(){return i(null)}}),[i]),Object(p.jsxs)("div",{className:"main",children:[Object(p.jsx)("p",{children:"GLAM URL Shortener"}),r?Object(p.jsxs)("div",{className:"short-url",children:[Object(p.jsx)("span",{style:{marginRight:"0.5rem"},children:"Short URL is "}),Object(p.jsx)("a",{style:{wordBreak:"break-all"},target:"_blank",rel:"noreferrer",href:r,children:c?r.slice(0,30)+"...":r}),Object(p.jsx)("span",{className:"copy-button",onClick:function(){var e=document.createElement("input");document.body.appendChild(e),e.value=r,e.select(),document.execCommand("copy",!1),e.remove(),ve("Copied")},children:xe})]}):null,Object(p.jsx)("div",{className:"loader",style:{display:C?"block":"none"},children:Object(p.jsx)("div",{className:"loading"})}),Object(p.jsxs)("form",{onSubmit:we,children:[Object(p.jsx)("input",{className:"url-input ".concat(le?"error":""),placeholder:"http(s)://",value:T,onClick:function(){return te(!0)},onChange:function(e){ee||te(!0),I(e.target.value)}}),U?Object(p.jsx)(S,{passwordProtect:Y,setPasswordProtect:_,password:F,setPassword:W,alias:K,setAlias:q,loading:C,aliasAllowed:Q,setAliasAllowed:X,passwordError:je,aliasError:me,passwordTouched:se,setPasswordTouched:ce,setError:s}):null,Object(p.jsxs)("div",{className:"form-buttons",children:[Object(p.jsx)(f.a,{type:"submit",className:b?"disabled":"",onClick:we,children:"Shorten"}),Object(p.jsx)("button",{type:"button",onClick:function(){g||M((function(e){return!e}))},className:g?"disabled":"",children:"Link Options"})]})]}),Object(p.jsx)("p",{style:{color:"#98978b",marginTop:"1rem",textAlign:"center"},children:'Did you know you can change the URL ending by clicking on "Link Options"?'})]})},y=a(155),C=a(150),E=(a(352),a(149)),L=a(510),A=a(506),T=a(129),I=a(186),D=a(504),N=(a(353),a(507)),U=a(505),M=a(92),R=a(499),P=a(292),Y=a(293),_=a(156),z=a(310),B=a(509),F=a(294),W=a(148),V=a(278),G=function(e){var t=e.isModalVisible,a=e.setIsModalVisible,n=e.modalInfo,s=e.modalStartDate,c=e.setModalStartDate,r=e.modalEndDate,i=e.setModalEndDate,d=e.setError,j=e.mobileMode,b=Object(l.useState)([]),h=Object(o.a)(b,2),O=h[0],m=h[1],f=Object(l.useState)([]),g=Object(o.a)(f,2),x=g[0],v=g[1],w=Object(l.useState)([]),S=Object(o.a)(w,2),k=S[0],y=S[1],C=Object(l.useState)([]),E=Object(o.a)(C,2),L=E[0],A=E[1];return Object(l.useEffect)((function(){var e=function(e){"Escape"===e.key&&a(!1)};return window.addEventListener("keypress",e),function(){window.removeEventListener("keypress",e)}}),[a]),Object(l.useEffect)((function(){n&&u.a.get("/api/url/short/clickDates/".concat(n.short)).then((function(e){var t=e.data.shortUrl.clicksDates;return m(t)})).catch((function(e){d("Something went wrong :("),console.log(e)}))}),[n,d]),Object(l.useEffect)((function(){if(O.length>0){var e={},t={},a={};O.forEach((function(n){var c=n.date,o=n.referrer,l=n.location,i=("00"+(c=new Date(c)).getDate()).slice(-2)+"/"+("00"+(c.getMonth()+1)).slice(-2)+"/"+c.getFullYear(),d=function(n,s){e[n]?e[n]=e[n]+1:e[n]=1,t[s]?t[s]=t[s]+1:t[s]=1,a[l]?a[l]=a[l]+1:a[l]=1};if(s&&r){var u=s.format("DD/MM/YYYY"),j=r.format("DD/MM/YYYY");i>=u&&i<=j&&d(i,o)}else if(s){i>=s.format("DD/MM/YYYY")&&d(i,o)}else if(r){i<=r.format("DD/MM/YYYY")&&d(i,o)}else d(i,o)}));var n=[],c=[],o=[];Object.keys(e).forEach((function(t){n.push({date:t,clicks:e[t]})})),n=n.sort(),Object.keys(t).forEach((function(e){return c.push({name:e,value:t[e]})})),Object.keys(a).forEach((function(e){o.push({country:e,value:a[e]})}));l=n,i=c,d=o,console.log(d),v(l),y(i),A(d)}var l,i,d}),[O,s,r]),Object(p.jsxs)(N.a,{title:"Clicks Stats",visible:t,footer:null,closeIcon:Object(p.jsx)("h2",{onClick:function(){return a(!1)},children:"\u2716"}),children:[Object(p.jsxs)("div",{className:"modal-top-half",children:[Object(p.jsxs)("div",{className:"links",children:[Object(p.jsxs)("p",{children:["Short Link :"," ",Object(p.jsx)("a",{target:"_blank",rel:"noreferrer",href:window.location.href.split("glamurlshortenerapplication")[0]+(null===n||void 0===n?void 0:n.short),children:null===n||void 0===n?void 0:n.short})]}),Object(p.jsxs)("p",{children:["Long Link :"," ",Object(p.jsx)("a",{target:"_blank",rel:"noreferrer",href:null===n||void 0===n?void 0:n.full,children:(null===n||void 0===n?void 0:n.full.slice(0,j?40:50))+"..."})]})]}),Object(p.jsxs)("div",{className:"dates",children:[Object(p.jsx)(U.a,{placeholder:"Start date",onChange:c,disabledDate:function(e){return r&&e>r||e>Date.now()},value:s,style:{marginBottom:"1rem"}}),Object(p.jsx)(U.a,{placeholder:"End date",onChange:i,disabledDate:function(e){return s?e>Date.now()||e<s:e>Date.now()},value:r})]})]}),O.length>0?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{className:"modal-bottom-half",children:[Object(p.jsxs)("div",{children:[Object(p.jsx)("h3",{className:"graph-label",children:"Traffic over time"}),Object(p.jsxs)(R.a,{width:j?350:500,height:280,data:x,children:[Object(p.jsx)(P.a,{dataKey:"date"}),Object(p.jsx)(Y.a,{dataKey:"clicks"}),Object(p.jsx)(_.a,{}),Object(p.jsx)(z.a,{dataKey:"clicks",fill:"#3E3F3A"})]})]}),Object(p.jsxs)("div",{children:[Object(p.jsx)("h3",{className:"graph-label",children:"Traffic sources"}),Object(p.jsxs)(B.a,{width:400,height:250,children:[Object(p.jsx)(F.a,{data:k,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,fill:"#3E3F3A"}),Object(p.jsx)(W.a,{}),Object(p.jsx)(_.a,{})]})]})]}),Object(p.jsx)("div",{className:"modal-world-map",children:L.length>0?Object(p.jsx)(V.WorldMap,{color:"#3E3F3A",title:"Traffic sources categorized by countries",size:"xl",data:L,frame:!0}):Object(p.jsx)(M.a,{style:{marginTop:"2rem"}})})]}):Object(p.jsx)(M.a,{style:{marginTop:"2rem"}})]})},K=function(e){var t=e.isModalVisible,a=e.setIsModalVisible,n=e.modalInfo,s=e.setError,c=e.urls,r=e.setUrls,l=e.accessToken,d=e.username,b=i.a.useState(!1),h=Object(o.a)(b,2),O=h[0],m=h[1],f=i.a.useState(n?n.full:""),g=Object(o.a)(f,2),x=g[0],v=g[1];return i.a.useEffect((function(){n&&v(n.full)}),[n]),Object(p.jsx)(N.a,{title:"Edit Long URL",okText:"Save",visible:t,closeIcon:Object(p.jsx)("h2",{onClick:function(){return a(!1)},children:"\u2716"}),confirmLoading:O,onOk:function(){x.length>0&&/(([\w]+:)?\/\/)?(([\d\w]|%[a-fA-f\d]{2,2})+(:([\d\w]|%[a-fA-f\d]{2,2})+)?@)?([\d\w][-\d\w]{0,253}[\d\w]\.)+[\w]{2,63}(:[\d]+)?(\/([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)*(\?(&?([-+_~.\d\w]|%[a-fA-f\d]{2,2})=?)*)?(#([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)?/.test(x)?(m(!0),u.a.patch("/api/url/shortUrls/long",{full:x,accessToken:l,username:d,id:null===n||void 0===n?void 0:n.key}).then((function(e){if(200===e.status){var t=Object(C.a)(c);t[null===n||void 0===n?void 0:n.idx].full=x,o="Saved",j.b.success(o),r(t),m(!1),a(!1)}else s("Something went wrong! :(");var o})).catch((function(e){var t;(console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?s(e.response.data.message):s("Something went wrong! :("))}))):(s("Invalid URL entered"),m(!1),a(!1))},onCancel:function(){return a(!1)},children:Object(p.jsxs)("div",{style:{width:"90%",display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(p.jsxs)("p",{style:{fontWeight:"900",textAlign:"center"},children:["Short URL :",Object(p.jsx)("span",{style:{marginLeft:"1rem",fontWeight:"400"},children:null===n||void 0===n?void 0:n.short})]}),Object(p.jsxs)("p",{style:{fontWeight:"900",textAlign:"center"},children:["Long URL :",Object(p.jsx)("input",{value:x,onChange:function(e){return v(e.target.value)},style:{border:"none",outline:"none",marginLeft:"1rem",width:"60vw",fontWeight:"400",marginTop:"1rem"}})]})]})})},q=E.a.Option,H=function(e){j.b.success(e)},J=function(e){var t=e.username,a=e.accessToken,n=e.setError,s=e.mobileMode,c=e.Admin,r=Object(l.useState)([{short:"asdasdasdas",full:"asdasdasdasdas",clicks:10}]),i=Object(o.a)(r,2),d=i[0],j=i[1],b=Object(l.useState)(!1),h=Object(o.a)(b,2),O=h[0],m=h[1],g=Object(l.useState)(!1),x=Object(o.a)(g,2),v=x[0],w=x[1],S=Object(l.useState)(0),k=Object(o.a)(S,2),N=k[0],U=k[1],M=Object(l.useState)([]),R=Object(o.a)(M,2),P=R[0],Y=R[1],_=Object(l.useState)(!1),z=Object(o.a)(_,2),B=z[0],F=z[1],W=Object(l.useState)(!1),V=Object(o.a)(W,2),J=V[0],Q=V[1],X=Object(l.useState)(!1),Z=Object(o.a)(X,2),$=Z[0],ee=Z[1],te=Object(l.useState)(!1),ae=Object(o.a)(te,2),ne=ae[0],se=ae[1],ce=Object(l.useState)(!1),re=Object(o.a)(ce,2),oe=re[0],le=re[1],ie=Object(l.useState)(!1),de=Object(o.a)(ie,2),ue=de[0],je=de[1],be=Object(l.useState)(!1),he=Object(o.a)(be,2),Oe=he[0],me=he[1],fe=Object(l.useState)(""),pe=Object(o.a)(fe,2),ge=pe[0],xe=pe[1],ve=Object(l.useState)(""),we=Object(o.a)(ve,2),Se=we[0],ke=we[1],ye=Object(l.useState)(1),Ce=Object(o.a)(ye,2),Ee=Ce[0],Le=Ce[1],Ae=Object(l.useState)(10),Te=Object(o.a)(Ae,2),Ie=Te[0],De=Te[1],Ne=Object(l.useState)("latest"),Ue=Object(o.a)(Ne,2),Me=Ue[0],Re=Ue[1],Pe=Object(l.useState)(3),Ye=Object(o.a)(Pe,2),_e=Ye[0],ze=Ye[1],Be=Object(l.useState)(!1),Fe=Object(o.a)(Be,2),We=Fe[0],Ve=Fe[1],Ge=Object(l.useState)(null),Ke=Object(o.a)(Ge,2),qe=Ke[0],He=Ke[1],Je=Object(l.useState)(null),Qe=Object(o.a)(Je,2),Xe=Qe[0],Ze=Qe[1],$e=Object(l.useState)(null),et=Object(o.a)($e,2),tt=et[0],at=et[1],nt=Object(l.useState)(!1),st=Object(o.a)(nt,2),ct=st[0],rt=st[1],ot=Object(l.useState)(null),lt=Object(o.a)(ot,2),it=lt[0],dt=lt[1],ut=[{title:"Created at",dataIndex:"createdAt",render:function(e){var t=new Date(e);return Object(p.jsx)("p",{children:("00"+(t.getMonth()+1)).slice(-2)+"/"+("00"+t.getDate()).slice(-2)+"/"+t.getFullYear()+" "+("00"+t.getHours()).slice(-2)+":"+("00"+t.getMinutes()).slice(-2)+":"+("00"+t.getSeconds()).slice(-2)})}},{title:"Short URL",dataIndex:"short",render:function(e,t){var a=t.idx;return Object(p.jsxs)("p",{children:[Object(p.jsx)("a",{target:"_blank",rel:"noreferrer",onClick:function(){var e=Object(C.a)(d);e[a]=Object(y.a)(Object(y.a)({},e[a]),{},{clicks:e[a].clicks+1}),j(e)},href:window.location.href.split("glamurlshortenerapplication")[0]+e,children:e}),Object(p.jsx)("span",{className:"copy-button-list",onClick:function(){var t=document.createElement("input");document.body.appendChild(t),t.value=window.location.href.split("glamurlshortenerapplication")[0]+e,t.select(),document.execCommand("copy",!1),t.remove(),H("Copied")},children:"Copy"})]})}},{title:"Long URL",dataIndex:"full",render:function(e,t){var a=t.idx,n=t.key,s=t.short;return Object(p.jsxs)("p",{children:[Object(p.jsx)("a",{target:"_blank",rel:"noreferrer",href:e,children:e.slice(0,50)+"..."}),Object(p.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"18px",cursor:"pointer"},onClick:function(){dt({key:n,idx:a,full:e,short:s}),rt(!0)},children:"\u270e"})]})}},{title:"Clicks",dataIndex:"clicks",render:function(e,t){var a=t.short,n=t.full;return Object(p.jsxs)("p",{style:{cursor:"pointer"},onClick:function(){He({short:a,full:n}),Ze(null),at(null),Ve(!0)},children:[e," \ud83d\udcc8"]})}},{title:"Protected",dataIndex:"password",render:function(e){return e?Object(p.jsx)("p",{style:{cursor:"pointer"},onClick:function(){return w((function(e){return!e}))},children:v?e:Object(p.jsx)("span",{children:"\ud83d\udd12"})}):Object(p.jsx)("h3",{children:"-"})}},{title:"Status",dataIndex:"status",render:function(e){return e?Object(p.jsx)("p",{children:"Enabled"}):Object(p.jsx)("p",{children:"Disabled"})}}];c&&ut.splice(1,0,{title:"Created By",dataIndex:"user"}),Object(l.useEffect)((function(){var e=c?"/api/url/admin":"/api/url";u.a.post(e,{accessToken:a,username:t,pageNumber:Ee,search:ge,sort:Me,filter:_e,pageSize:Ie}).then((function(e){var a=[];e.data.shortUrls.forEach((function(e,t){var n=e.short,s=e.full,c=e.clicks,r=e._id,o=e.password,l=e.createdAt,i=e.status,d=e.user;a.push({short:n,full:s,clicks:c,key:r,password:o,createdAt:l,status:i,idx:t,user:d})})),j(a);var s=c?"/api/url/admin/shortUrls/count/".concat(t):"/api/url/shortUrls/count/".concat(t);u.a.get(s).then((function(e){var t=e.data.count;return U(t)})).catch((function(e){var t;(console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?n(e.response.data.message):n("Something went wrong! :("))}))})).catch((function(e){var t;(console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?n(e.response.data.message):n("Something went wrong! :("))}))}),[t,a,n,Ee,ge,_e,Me,O,Ie,c]),Object(l.useEffect)((function(){var e=setTimeout((function(){xe(Se),Le(1)}),1e3);return function(){return clearTimeout(e)}}),[Se]);var jt=function(e){le(!0),e?(je(!0),se(!0)):(me(!0),ee(!0));var s=[];P.forEach((function(t){d.find((function(e){return e.key===t})).status!==e&&s.push(t)})),u.a.patch("/api/url/shortUrls",{accessToken:a,username:t,ids:s,status:e}).then((function(){H(e?"Enabled":"Disabled"),ee(!1),le(!1),Y([]),e?(je(!1),se(!1)):(me(!1),ee(!1));var t=Object(C.a)(d);t=t.map((function(t){return s.some((function(e){return t.key===e}))?Object(y.a)(Object(y.a)({},t),{},{status:e}):t})),j(t)})).catch((function(t){var a;(Y([]),ee(!1),le(!1),e?(je(!1),se(!1)):(me(!1),ee(!1)),console.log(t),t.response)&&((null===(a=t.response.data)||void 0===a?void 0:a.message)?n(t.response.data.message):n("Something went wrong! :("))}))},bt={selectedRows:P,onChange:function(e){return Y(e)}},ht=P.length>0;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(G,{isModalVisible:We,setIsModalVisible:Ve,modalInfo:qe,modalStartDate:Xe,setModalStartDate:Ze,modalEndDate:tt,setModalEndDate:at,setError:n,mobileMode:s}),Object(p.jsx)(K,{isModalVisible:ct,setIsModalVisible:rt,modalInfo:it,setError:n,urls:d,setUrls:j,accessToken:a,username:t}),Object(p.jsxs)("div",{className:"list-container",children:[Object(p.jsxs)("p",{children:["Table of links generated by ",c?"others":"you"]}),Object(p.jsxs)("div",{children:[Object(p.jsxs)("div",{style:{marginBottom:"1rem"},children:[Object(p.jsx)(L.a,{title:"Are you sure to delete selected URLs?",onCancel:function(){F(!0),je(!0),me(!0);var e=[];P.forEach((function(t){e.push(t)})),u.a.delete("/api/url/shortUrls",{data:{accessToken:a,username:t,ids:e}}).then((function(){H("Deleted"),F(!1),je(!1),me(!1),Le(1),Y([]),m((function(e){return!e}))})).catch((function(e){var t;(Y([]),F(!1),je(!1),me(!1),m((function(e){return!e})),console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?n(e.response.data.message):n("Something went wrong! :("))}))},okText:"Cancel",cancelText:"Delete",children:Object(p.jsx)(f.a,{style:{marginRight:"0.5rem"},type:"danger",disabled:!ht||oe,loading:B,children:"Delete"})}),"  ",Object(p.jsx)(L.a,{title:"Are you sure to disable selected URLs?",onCancel:function(){return jt(!1)},okText:"Cancel",cancelText:"Disable",children:Object(p.jsx)(f.a,{style:{marginLeft:"0.5rem",marginRight:"0.5rem"},type:"danger",disabled:!ht||ue,loading:$,children:"Disable"})}),"  ",Object(p.jsx)(L.a,{title:"Are you sure to enable selected URLs?",onCancel:function(){return jt(!0)},okText:"Cancel",cancelText:"Enable",children:Object(p.jsx)(f.a,{style:{marginLeft:"0.5rem"},type:"primary",disabled:!ht||Oe,loading:ne,children:"Enable"})}),Object(p.jsx)("span",{style:{marginLeft:8,position:"relative",top:"5px"},children:ht?"Selected ".concat(P.length," items"):""})]}),Object(p.jsx)("div",{children:Object(p.jsx)(A.a,{placeholder:"Search....",value:Se,onChange:function(e){return ke(e.target.value)}})}),Object(p.jsxs)("div",{children:[Object(p.jsx)(T.a,{title:"Sort by",children:Object(p.jsxs)(E.a,{value:Me,onChange:function(e){Le(1),Re(e)},children:[Object(p.jsx)(q,{value:"latest",children:"Latest"}),Object(p.jsx)(q,{value:"oldest",children:"Oldest"}),Object(p.jsx)(q,{value:"mostclicked",children:"Most clicked"}),Object(p.jsx)(q,{value:"leastclicked",children:"Least clicked"})]})}),Object(p.jsx)(T.a,{title:"Link enabled/disabled filter",children:Object(p.jsxs)(I.a.Group,{onChange:function(e){Le(1),ze(e.target.value)},value:_e,children:[Object(p.jsx)(I.a,{value:1,children:"Enabled"}),Object(p.jsx)(I.a,{value:2,children:"Disabled"}),Object(p.jsx)(I.a,{value:3,children:"Both"})]})})]})]}),Object(p.jsx)(D.a,{rowSelection:bt,columns:ut,dataSource:d,scroll:{x:1e3},pagination:{current:Ee,total:N,onChange:Le,position:["topRight"],onShowSizeChange:De}}),N>0?Object(p.jsx)(L.a,{title:"Are you sure to delete all URLs generated by you?",onCancel:function(){Q(!0);var e=c?"/api/url/admin/shortUrls/all":"/api/url/shortUrls/all";u.a.delete(e,{data:{accessToken:a,username:t}}).then((function(){j([]),U(0),F(!1),Le(1),m((function(e){return!e}))})).catch((function(e){var t;(Q(!1),console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?n(e.response.data.message):n("Something went wrong! :("))}))},okText:"Cancel",cancelText:"Delete",children:Object(p.jsxs)(f.a,{style:{margin:"1rem 0"},type:"danger",loading:J,children:["Delete all ",N," links generated by"," ",c?"other users":"you"]})}):null]})]})},Q={appId:"d4da2439-fc78-49c7-a5d8-b3288224a42d",redirectUri:window.location.href.split("glamurlshortenerapplication")[0],scopes:["user.read"],authority:"https://login.microsoftonline.com/".concat("7c87cabd-9999-4fe8-84b5-a3092b16040e")},X=Object(r.i)((function(e){var t=e.location,a=null,n=Object(l.useState)("home"),s=Object(o.a)(n,2),i=s[0],d=s[1],O=Object(l.useState)(!1),f=Object(o.a)(O,2),x=f[0],v=f[1],w=Object(l.useState)(!1),S=Object(o.a)(w,2),y=S[0],C=S[1],E=Object(l.useState)(!1),L=Object(o.a)(E,2),A=L[0],T=L[1],I=Object(l.useState)(!1),D=Object(o.a)(I,2),N=D[0],U=D[1],M=Object(l.useState)(null),R=Object(o.a)(M,2),P=R[0],Y=R[1],_=Object(l.useState)(null),z=Object(o.a)(_,2),B=z[0],F=z[1],W=Object(l.useState)(null),V=Object(o.a)(W,2),G=V[0],K=V[1],q=Object(l.useState)(!1),H=Object(o.a)(q,2),X=H[0],Z=H[1],$=Object(l.useState)(null),ee=Object(o.a)($,2),te=ee[0],ae=ee[1],ne=Object(l.useState)(null),se=Object(o.a)(ne,2),ce=se[0],re=se[1],oe=Object(r.h)(),le=oe.path,ie=oe.url,de=Object(r.g)();Object(l.useEffect)((function(){var e=t.pathname.split("/");2===e.length?d("home"):"about"===e[2]?d("about"):"links"===e[2]?d("links"):"admin"===e[2]?d("admin"):d("home")}),[t]),Object(l.useEffect)((function(){localStorage.getItem("redirect")?t.pathname.length>28&&localStorage.setItem("redirect",t.pathname):localStorage.setItem("redirect",t.pathname),window.innerWidth<768?U(!0):U(!1);var e=window.addEventListener("resize",(function(){window.innerWidth<768?U(!0):U(!1)})),a=localStorage.getItem("accesstoken"),n=localStorage.getItem("username"),s=localStorage.getItem("name");return a&&n&&s&&!y&&(Z(!0),u.a.post("/api/authenticate",{accessToken:a,username:n}).then((function(e){if(Z(!1),200===e.status){v(!0),e.data.admin&&T(!0),Y(s),F(a),K(n),C(!0);var t=localStorage.getItem("redirect");t&&(de.push(t),localStorage.removeItem("redirect"))}else Z(!1),ae("Something went wrong! :(")})).catch((function(e){var t,a;(Z(!1),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?ae(e.response.data.message):e.response&&((null===(a=e.response.data)||void 0===a?void 0:a.message)?ae(e.response.data.message):ae("Something went wrong! :(")));console.log(e)}))),function(){window.removeEventListener("resize",e)}}),[x,t,y,de]),Object(l.useEffect)((function(){var e;te&&(e=te,j.b.error(e),ae(null))}),[te]);var ue=new h.a({auth:{clientId:Q.appId,redirectUri:Q.redirectUri,authority:Q.authority}}),je=function(){Z(!0);try{ue.logoutPopup().then((function(){localStorage.removeItem("name"),localStorage.removeItem("accesstoken"),localStorage.removeItem("username"),clearTimeout(a),Z(!1),Y(null),v(!1),T(!1),F(null),K(null),re(null),d("home")}))}catch(t){var e;if(console.log(t),t.response)(null===(e=t.response.data)||void 0===e?void 0:e.message)?ae(t.response.data.message):ae("Something went wrong! :(")}};return Object(p.jsx)("div",{children:Object(p.jsxs)("div",{children:[Object(p.jsx)(g,{user:P,authenticated:x,login:function(){Z(!0);try{ue.loginPopup({scopes:Q.scopes,prompt:"select_account"}).then((function(e){a=setTimeout(je,3599998),localStorage.setItem("name",e.account.name),localStorage.setItem("username",e.account.username),localStorage.setItem("accesstoken",e.accessToken),v(!0)}))}catch(t){var e;if(console.log(t),t.response)(null===(e=t.response.data)||void 0===e?void 0:e.message)?ae(t.response.data.message):ae("Something went wrong! :(")}},logout:je,authenticationButtonLoading:X,setAuthenticationButtonLoading:Z}),Object(p.jsx)("div",{className:"menu-container",children:Object(p.jsxs)(b.a,{onClick:function(e){return d(e.key)},selectedKeys:[i],mode:"horizontal",style:{justifyContent:"center"},children:[Object(p.jsx)(b.a.Item,{children:Object(p.jsx)(c.b,{to:ie,children:"Home"})},"home"),Object(p.jsx)(b.a.Item,{children:Object(p.jsx)(c.b,{to:"".concat(ie,"/about"),children:"About"})},"about"),x?Object(p.jsx)(b.a.Item,{children:Object(p.jsx)(c.b,{to:"".concat(ie,"/links"),children:"Links"})},"links"):null,A?Object(p.jsx)(b.a.Item,{children:Object(p.jsx)(c.b,{to:"".concat(ie,"/admin"),children:"Admin"})},"admin"):null]})}),Object(p.jsxs)(r.d,{children:[Object(p.jsx)(r.b,{exact:!0,path:le,children:Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(k,{authenticated:x,accessToken:B,username:G,setError:ae,mobileMode:N,shortURL:ce,setShortURL:re}),ce?Object(p.jsx)(m.a,{className:"qr-code-app",value:ce}):null]})}),Object(p.jsx)(r.b,{exact:!0,path:"".concat(le,"/about"),children:Object(p.jsxs)("div",{className:"app-about",children:["GLAM URL shortener is a minimalistic link shortening platform built specifically for Oxford GLAM by",Object(p.jsxs)("a",{target:"_blank",rel:"noreferrer",href:"https://www.cloudmantra.net",children:[" cloudmantra.net",Object(p.jsx)("sup",{children:"TM"})]})]})}),Object(p.jsx)(r.b,{exact:!0,path:"".concat(le,"/links"),children:x?Object(p.jsx)(J,{accessToken:B,username:G,setError:ae,mobileMode:N}):Object(p.jsx)(r.a,{to:le})}),Object(p.jsx)(r.b,{path:"".concat(le,"/admin"),children:x?A?Object(p.jsx)(J,{accessToken:B,username:G,setError:ae,mobileMode:N,Admin:!0}):Object(p.jsx)(r.a,{to:"".concat(le,"/links")}):Object(p.jsx)(r.a,{to:le})})]})]})})})),Z=function(){var e=Object(l.useState)("Redirecting..."),t=Object(o.a)(e,2),a=t[0],n=t[1],s=Object(l.useState)(!1),c=Object(o.a)(s,2),r=c[0],i=c[1],d=Object(l.useState)(""),j=Object(o.a)(d,2),b=j[0],h=j[1];Object(l.useEffect)((function(){u.a.get("/api/url/short/".concat(window.location.pathname.slice(1),"?referrer=").concat(document.referrer)).then((function(e){var t=e.data.shortUrl;"string"===typeof t&&"password protected"===t?i(!0):"string"===typeof t&&"disabled"===t?n("Link Disabled"):window.location.href=t.full})).catch((function(e){var t;(console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?n(e.response.data.message):n("Something went wrong! :("))}))}),[]);var O=function(e){var t=function(){u()({method:"POST",url:"/api/url/short/".concat(window.location.pathname.slice(1),"?referrer=").concat(document.referrer),data:{password:b}}).then((function(e){var t=e.data.shortUrl;window.location.href=t.full})).catch((function(e){var t;(console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?n(e.response.data.message):n("Something went wrong! :("))}))};"Enter"===e.key?t():e.key||t()};return Object(p.jsxs)("div",{style:{width:"100vw",height:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[Object(p.jsx)("p",{style:{fontSize:"5vw",marginBottom:"2rem",color:"white",width:"90vw",height:"100px",backgroundColor:"rgb(62, 63, 58)",display:"flex",justifyContent:"center",alignItems:"center"},children:"GLAM URL Shortener"}),Object(p.jsx)("h1",{style:{marginBottom:"2rem",color:"rgb(62, 63, 58)"},children:a}),r?Object(p.jsxs)("div",{style:{display:"flex"},children:[Object(p.jsx)("input",{style:{padding:"1rem 2rem",textAlign:"center",fontSize:"1rem"},placeholder:"Enter Password",value:b,onChange:function(e){var t=e.target.value;return h(t)},onKeyPress:O}),Object(p.jsx)("span",{style:{marginLeft:"1rem",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center"},onClick:O,children:"Go"})]}):null]})};s.a.render(Object(p.jsx)(c.a,{children:Object(p.jsxs)(r.d,{children:[Object(p.jsx)(r.b,{exact:!0,path:"/",children:Object(p.jsx)(r.a,{to:"/glamurlshortenerapplication"})}),Object(p.jsx)(r.b,{path:"/glamurlshortenerapplication",component:X}),Object(p.jsx)(r.b,{path:"/:shortUrl",component:Z})]})}),document.getElementById("root"))}},[[495,1,2]]]);
//# sourceMappingURL=main.fbabeabd.chunk.js.map