(this.webpackJsonpreact2=this.webpackJsonpreact2||[]).push([[0],{321:function(e,t,a){},348:function(e,t,a){},351:function(e,t,a){},352:function(e,t,a){},353:function(e,t,a){},354:function(e,t,a){},496:function(e,t,a){"use strict";a.r(t);var n=a(40),c=a.n(n),s=a(66),r=a(39),o=a(9),l=(a(321),a(0)),i=a.n(l),d=a(43),u=a.n(d),j=a(306),b=a(115),h=a(504),O=a(275),m=a.n(O),f=(a(348),a(44)),p=a(6),g=function(e){var t=e.logout,a=e.user,n=e.login,c=e.authenticated;return Object(p.jsxs)("div",{className:"header",children:[Object(p.jsx)("div",{children:Object(p.jsx)("p",{children:"GLAM URL Shortener"})}),Object(p.jsx)("div",{className:c?"":"fix-view-div",children:c?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("p",{children:["Welcome ",Object(p.jsx)("span",{className:"header-user-tab",children:a})]}),Object(p.jsx)(f.a,{className:"logout-button",onClick:t,children:"Sign out"})]}):Object(p.jsx)(f.a,{className:"login-button fix-view-button",onClick:n,children:"Sign in with AD"})})]})},x=a(131),v=a.n(x),w=a(277),S=(a(351),a(352),function(e){var t=e.passwordProtect,a=e.setPasswordProtect,n=e.password,c=e.setPassword,s=e.alias,r=e.setAlias,l=(e.expire,e.setExpire,e.loading),d=e.aliasAllowed,j=e.setAliasAllowed,b=e.passwordError,h=e.aliasError,O=e.passwordTouched,m=e.setPasswordTouched,f=e.setError,g=i.a.useState(s),x=Object(o.a)(g,2),v=x[0],w=x[1],S=i.a.useState("Available"),y=Object(o.a)(S,2),k=y[0],E=y[1];return i.a.useEffect((function(){if(v.length>0){if(v.startsWith("api")||v.startsWith("glamurlshortenerapplication"))return j(!1),void E("Not available");j(!1),E("Checking")}else j(!0);var e=setTimeout((function(){v.length>0?u.a.get("/api/url/short/".concat(v,"/exists")).then((function(e){e.data.exists?(j(!1),E("Not available")):(j(!0),r(v),E("Available"))})).catch((function(e){var t;e.response&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?f(e.response.data.message):f("Something went wrong! :("));r(""),w(""),j(!0),console.log(e)})):(r(""),j(!0))}),1e3);return function(){clearTimeout(e)}}),[v,r,j,f]),Object(p.jsxs)("div",{className:"link-options",children:[Object(p.jsxs)("div",{className:"password-protect",children:[Object(p.jsxs)("label",{className:"container",children:[Object(p.jsx)("div",{className:t?"not-selected":"selected",children:"Public"}),Object(p.jsx)("input",{disabled:l,type:"radio",checked:!t,onChange:function(){c(""),m(!1),a(!1)},name:"radio"}),Object(p.jsx)("span",{className:"checkmark"})]}),Object(p.jsxs)("label",{className:"container",children:[Object(p.jsx)("div",{className:t?"selected":"not-selected",children:"Secret"}),Object(p.jsx)("input",{disabled:l,type:"radio",checked:t,onChange:function(){return a(!0)},name:"radio"}),Object(p.jsx)("span",{className:"checkmark"})]})]}),t?Object(p.jsx)("input",{className:"app-input ".concat(b?"error":""),style:{marginTop:"0px",marginBottom:"1rem"},placeholder:"******** (required if secret is selected)",value:n,onClick:function(){return m(!0)},onChange:function(e){O||m(!0),c(e.target.value)}}):null,Object(p.jsxs)("div",{className:"alias",children:[Object(p.jsx)("label",{children:window.location.href.split("glamurlshortenerapplication")[0]}),Object(p.jsx)("input",{className:"app-input ".concat(h?"error":""),placeholder:"custom alias (optional)",value:v,onChange:function(e){return w(e.target.value)}}),v.length>0?Object(p.jsx)("span",{className:d?"available":"notavailable",children:k}):null]})]})}),y=function(e){var t=e.accessToken,a=e.username,n=e.authenticated,c=e.setError,s=e.mobileMode,r=e.shortURL,i=e.setShortURL,d=Object(l.useState)(!0),j=Object(o.a)(d,2),b=j[0],h=j[1],O=Object(l.useState)(!1),m=Object(o.a)(O,2),g=m[0],x=m[1],y=Object(l.useState)(!1),k=Object(o.a)(y,2),E=k[0],C=k[1],L=Object(l.useState)(""),T=Object(o.a)(L,2),A=T[0],I=T[1],D=Object(l.useState)(!1),N=Object(o.a)(D,2),U=N[0],M=N[1],R=Object(l.useState)(!1),P=Object(o.a)(R,2),Y=P[0],_=P[1],z=Object(l.useState)(""),B=Object(o.a)(z,2),W=B[0],F=B[1],K=Object(l.useState)(""),G=Object(o.a)(K,2),V=G[0],q=G[1],H=Object(l.useState)(!0),J=Object(o.a)(H,2),Q=J[0],X=J[1],Z=Object(l.useState)(!1),$=Object(o.a)(Z,2),ee=$[0],te=$[1],ae=Object(l.useState)(!1),ne=Object(o.a)(ae,2),ce=ne[0],se=ne[1],re=Object(l.useState)(!1),oe=Object(o.a)(re,2),le=oe[0],ie=oe[1],de=Object(l.useState)(!1),ue=Object(o.a)(de,2),je=ue[0],be=ue[1],he=Object(l.useState)(!1),Oe=Object(o.a)(he,2),me=Oe[0],fe=Oe[1],pe=Object(l.useState)(!1),ge=Object(o.a)(pe,2),xe=ge[0],ve=ge[1],we=Object(l.useState)("Copy"),Se=Object(o.a)(we,2),ye=Se[0],ke=Se[1],Ee=function(){var e=Object(w.a)(v.a.mark((function e(s){var r,o,l,d,j;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.preventDefault(),n){e.next=4;break}return c("Please login to shorten URL"),e.abrupt("return");case 4:if(!b){e.next=7;break}return Ce(),e.abrupt("return");case 7:return C(!0),x(!0),h(!0),e.prev=10,r={full:A,password:W.length>0?W:void 0,short:V.length>0?V:void 0,accessToken:t,username:a},ee&&(r.state=!0),e.next=15,u()({method:"POST",url:"/api/url/shortUrls",data:r});case 15:201===(o=e.sent).status||200===o.status?(l=o.data.shortUrl.short,ke("Copy"),i(window.location.href.split("glamurlshortenerapplication")[0]+l),I(""),M(!1),_(!1),F(""),q(""),te(!1),X(!0),se(!1),ie(!1),be(!1),fe(!1),ve(!1)):("shortURL already exists"===(d=o.data.error)?(c("Alias is already in use"),q("")):c(d),h(!1)),C(!1),x(!1),e.next=28;break;case 21:e.prev=21,e.t0=e.catch(10),e.t0.response&&((null===(j=e.t0.response.data)||void 0===j?void 0:j.message)?c(e.t0.response.data.message):c("Something went wrong! :(")),h(!1),C(!1),x(!1),console.log(e.t0);case 28:case"end":return e.stop()}}),e,null,[[10,21]])})));return function(t){return e.apply(this,arguments)}}(),Ce=function(){0===A.length&&be(!0),U&&(Y&&0===W.length&&fe(!0),V.length>0&&(Q||ve(!0)))};return Object(l.useEffect)((function(){A.length>0&&/(([\w]+:)?\/\/)?(([\d\w]|%[a-fA-f\d]{2,2})+(:([\d\w]|%[a-fA-f\d]{2,2})+)?@)?([\d\w][-\d\w]{0,253}[\d\w]\.)+[\w]{2,63}(:[\d]+)?(\/([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)*(\?(&?([-+_~.\d\w]|%[a-fA-f\d]{2,2})=?)*)?(#([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)?/.test(A)?(be(!1),U?Y?W.length>0&&Q?(fe(!1),ve(!1),h(!1)):(0===W.length&&le&&fe(!0),Q||ve(!0),h(!0)):Q?(fe(!1),ve(!1),h(!1)):(ve(!0),h(!0)):(fe(!1),ve(!1),h(!1))):(ce&&be(!0),h(!0))}),[A,U,Y,W,Q,le,ce]),Object(l.useEffect)((function(){n||(ke("Copy"),i(null),I(""),M(!1),_(!1),F(""),q(""),X(!0),se(!1),ie(!1),be(!1),fe(!1),ve(!1))}),[n,i]),Object(l.useEffect)((function(){return function(){return i(null)}}),[i]),Object(p.jsxs)("div",{className:"main",children:[Object(p.jsx)("p",{children:"GLAM URL Shortener"}),r?Object(p.jsxs)("div",{className:"short-url",children:[Object(p.jsx)("span",{style:{marginRight:"0.5rem"},children:"Short URL is "}),Object(p.jsx)("a",{style:{wordBreak:"break-all"},target:"_blank",rel:"noreferrer",href:r,children:s?r.slice(0,30)+"...":r}),Object(p.jsx)("span",{className:"copy-button",onClick:function(){var e=document.createElement("input");document.body.appendChild(e),e.value=r,e.select(),document.execCommand("copy",!1),e.remove(),ke("Copied")},children:ye})]}):null,Object(p.jsx)("div",{className:"loader",style:{display:E?"block":"none"},children:Object(p.jsx)("div",{className:"loading"})}),Object(p.jsxs)("form",{onSubmit:Ee,children:[Object(p.jsx)("input",{className:"url-input ".concat(je?"error":""),placeholder:"http(s)://",value:A,onClick:function(){return se(!0)},onChange:function(e){ce||se(!0),I(e.target.value)}}),U?Object(p.jsx)(S,{passwordProtect:Y,setPasswordProtect:_,password:W,setPassword:F,alias:V,setAlias:q,expire:ee,setExpire:te,loading:E,aliasAllowed:Q,setAliasAllowed:X,passwordError:me,aliasError:xe,passwordTouched:le,setPasswordTouched:ie,setError:c}):null,Object(p.jsxs)("div",{className:"form-buttons",children:[Object(p.jsx)(f.a,{type:"submit",className:b?"disabled":"",onClick:Ee,children:"Shorten"}),Object(p.jsx)("button",{type:"button",onClick:function(){g||M((function(e){return!e}))},className:g?"disabled":"",children:"Customize"})]})]})]})},k=a(155),E=a(150),C=(a(353),a(149)),L=a(511),T=a(507),A=a(130),I=a(186),D=a(300),N=a(505),U=(a(354),a(508)),M=a(506),R=a(93),P=a(500),Y=a(293),_=a(294),z=a(156),B=a(311),W=a(510),F=a(295),K=a(148),G=a(278),V=function(e){var t=e.isModalVisible,a=e.modalInfo,n=e.setModalInfo,c=e.modalStartDate,i=e.setModalStartDate,d=e.modalEndDate,j=e.setModalEndDate,b=e.setError,h=e.mobileMode,O=e.Admin,m=Object(l.useState)([]),f=Object(o.a)(m,2),g=f[0],x=f[1],v=Object(l.useState)([]),w=Object(o.a)(v,2),S=w[0],y=w[1],k=Object(l.useState)([]),E=Object(o.a)(k,2),C=E[0],L=E[1],T=Object(l.useState)([]),A=Object(o.a)(T,2),I=A[0],D=A[1],N=Object(r.g)();return Object(l.useEffect)((function(){var e=function(){N.push("/glamurlshortenerapplication/".concat(O?"admin":"links"))};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[n,j,i,N,O]),Object(l.useEffect)((function(){a&&u.a.get("/api/url/short/clickdates/".concat(a.short)).then((function(e){var t=e.data.shortUrl.clicksDates;return x(t)})).catch((function(e){b("Something went wrong :("),console.log(e)}))}),[a,b]),Object(l.useEffect)((function(){if(g.length>0){var e={},t={},a={};g.forEach((function(n){var s=n.date,r=n.referrer,o=n.location,l=("00"+(s=new Date(s)).getDate()).slice(-2)+"/"+("00"+(s.getMonth()+1)).slice(-2)+"/"+s.getFullYear(),i=function(n,c){e[n]?e[n]=e[n]+1:e[n]=1,t[c]?t[c]=t[c]+1:t[c]=1,a[o]?a[o]=a[o]+1:a[o]=1};if(c&&d){var u=c.format("DD/MM/YYYY"),j=d.format("DD/MM/YYYY");l>=u&&l<=j&&i(l,r)}else if(c){l>=c.format("DD/MM/YYYY")&&i(l,r)}else if(d){l<=d.format("DD/MM/YYYY")&&i(l,r)}else i(l,r)}));var n=[],s=[],r=[];Object.keys(e).forEach((function(t){n.push({date:t,clicks:e[t]})})),n=n.sort(),Object.keys(t).forEach((function(e){return s.push({name:e,value:t[e]})})),Object.keys(a).forEach((function(e){r.push({country:e,value:a[e]})}));o=s,l=r,y(n),L(o),D(l)}var o,l}),[g,c,d]),Object(p.jsxs)(U.a,{title:"Clicks Stats".concat(h?"":" (Press any key to close modal)"),visible:t,footer:null,closeIcon:Object(p.jsx)(s.b,{to:"/glamurlshortenerapplication/".concat(O?"admin":"links"),children:"\u2716"}),children:[Object(p.jsxs)("div",{className:"modal-top-half",children:[Object(p.jsxs)("div",{className:"links",children:[Object(p.jsxs)("p",{children:["Short Link :"," ",Object(p.jsx)("a",{target:"_blank",rel:"noreferrer",href:window.location.href.split("glamurlshortenerapplication")[0]+(null===a||void 0===a?void 0:a.short),children:null===a||void 0===a?void 0:a.short})]}),Object(p.jsxs)("p",{children:["Long Link :"," ",Object(p.jsx)("a",{target:"_blank",rel:"noreferrer",href:null===a||void 0===a?void 0:a.full,children:(null===a||void 0===a?void 0:a.full.slice(0,h?40:50))+"..."})]})]}),Object(p.jsxs)("div",{className:"dates",children:[Object(p.jsx)(M.a,{placeholder:"Start date",onChange:i,disabledDate:function(e){return d&&e>d||e>Date.now()},value:c,style:{marginBottom:"1rem"}}),Object(p.jsx)(M.a,{placeholder:"End date",onChange:j,disabledDate:function(e){return c?e>Date.now()||e<c:e>Date.now()},value:d})]})]}),g.length>0?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{className:"modal-bottom-half",children:[Object(p.jsxs)("div",{children:[Object(p.jsx)("h3",{className:"graph-label",children:"Traffic over time"}),Object(p.jsxs)(P.a,{width:h?350:500,height:280,data:S,children:[Object(p.jsx)(Y.a,{dataKey:"date"}),Object(p.jsx)(_.a,{dataKey:"clicks"}),Object(p.jsx)(z.a,{}),Object(p.jsx)(B.a,{dataKey:"clicks",fill:"#3E3F3A"})]})]}),Object(p.jsxs)("div",{children:[Object(p.jsx)("h3",{className:"graph-label",children:"Traffic sources"}),Object(p.jsxs)(W.a,{width:400,height:250,children:[Object(p.jsx)(F.a,{data:C,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,fill:"#3E3F3A"}),Object(p.jsx)(K.a,{}),Object(p.jsx)(z.a,{})]})]})]}),Object(p.jsx)("div",{className:"modal-world-map",children:I.length>0?Object(p.jsx)(G.WorldMap,{color:"#3E3F3A",title:"Traffic sources categorized by countries",size:"xl",data:I,frame:!0}):Object(p.jsx)(R.a,{style:{marginTop:"2rem"}})})]}):Object(p.jsx)(R.a,{style:{marginTop:"2rem"}})]})},q=function(e){var t=e.isModalVisible,a=e.setIsModalVisible,n=e.modalInfo,c=e.setError,s=e.urls,r=e.setUrls,l=e.accessToken,d=e.username,b=i.a.useState(!1),h=Object(o.a)(b,2),O=h[0],m=h[1],f=i.a.useState(n?n.full:""),g=Object(o.a)(f,2),x=g[0],v=g[1];return i.a.useEffect((function(){n&&v(n.full)}),[n]),Object(p.jsx)(U.a,{title:"Edit Long URL",okText:"Save",visible:t,closeIcon:Object(p.jsx)("h2",{onClick:function(){return a(!1)},children:"\u2716"}),confirmLoading:O,onOk:function(){x.length>0&&/(([\w]+:)?\/\/)?(([\d\w]|%[a-fA-f\d]{2,2})+(:([\d\w]|%[a-fA-f\d]{2,2})+)?@)?([\d\w][-\d\w]{0,253}[\d\w]\.)+[\w]{2,63}(:[\d]+)?(\/([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)*(\?(&?([-+_~.\d\w]|%[a-fA-f\d]{2,2})=?)*)?(#([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)?/.test(x)?(m(!0),u.a.patch("/api/url/shortUrls/long",{full:x,accessToken:l,username:d,id:null===n||void 0===n?void 0:n.key}).then((function(e){if(200===e.status){var t=Object(E.a)(s);t[null===n||void 0===n?void 0:n.idx].full=x,o="Saved",j.b.success(o),r(t),m(!1),a(!1)}else c("Something went wrong! :(");var o})).catch((function(e){var t;(console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?c(e.response.data.message):c("Something went wrong! :("))}))):(c("Invalid URL entered"),m(!1),a(!1))},onCancel:function(){return a(!1)},children:Object(p.jsxs)("div",{style:{width:"90%",display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(p.jsxs)("p",{style:{fontWeight:"900",textAlign:"center"},children:["Short URL :",Object(p.jsx)("span",{style:{marginLeft:"1rem",fontWeight:"400"},children:null===n||void 0===n?void 0:n.short})]}),Object(p.jsxs)("p",{style:{fontWeight:"900",textAlign:"center"},children:["Long URL :",Object(p.jsx)("input",{value:x,onChange:function(e){return v(e.target.value)},style:{border:"none",outline:"none",marginLeft:"1rem",width:"60vw",fontWeight:"400",marginTop:"1rem"}})]})]})})},H=C.a.Option,J=function(e){j.b.success(e)},Q=function(e){var t=e.username,a=e.accessToken,n=e.setError,c=e.mobileMode,i=e.Admin,d=Object(l.useState)([]),j=Object(o.a)(d,2),b=j[0],h=j[1],O=Object(l.useState)(!1),m=Object(o.a)(O,2),g=m[0],x=m[1],v=Object(l.useState)(!0),w=Object(o.a)(v,2),S=w[0],y=w[1],U=Object(l.useState)(!1),M=Object(o.a)(U,2),R=M[0],P=M[1],Y=Object(l.useState)(0),_=Object(o.a)(Y,2),z=_[0],B=_[1],W=Object(l.useState)([]),F=Object(o.a)(W,2),K=F[0],G=F[1],Q=Object(l.useState)(!1),X=Object(o.a)(Q,2),Z=X[0],$=X[1],ee=Object(l.useState)(!1),te=Object(o.a)(ee,2),ae=te[0],ne=te[1],ce=Object(l.useState)(!1),se=Object(o.a)(ce,2),re=se[0],oe=se[1],le=Object(l.useState)(!1),ie=Object(o.a)(le,2),de=ie[0],ue=ie[1],je=Object(l.useState)(!1),be=Object(o.a)(je,2),he=be[0],Oe=be[1],me=Object(l.useState)(!1),fe=Object(o.a)(me,2),pe=fe[0],ge=fe[1],xe=Object(l.useState)(!1),ve=Object(o.a)(xe,2),we=ve[0],Se=ve[1],ye=Object(l.useState)(""),ke=Object(o.a)(ye,2),Ee=ke[0],Ce=ke[1],Le=Object(l.useState)(""),Te=Object(o.a)(Le,2),Ae=Te[0],Ie=Te[1],De=Object(l.useState)(1),Ne=Object(o.a)(De,2),Ue=Ne[0],Me=Ne[1],Re=Object(l.useState)(10),Pe=Object(o.a)(Re,2),Ye=Pe[0],_e=Pe[1],ze=Object(l.useState)("latest"),Be=Object(o.a)(ze,2),We=Be[0],Fe=Be[1],Ke=Object(l.useState)(3),Ge=Object(o.a)(Ke,2),Ve=Ge[0],qe=Ge[1],He=Object(l.useState)(null),Je=Object(o.a)(He,2),Qe=Je[0],Xe=Je[1],Ze=Object(l.useState)(null),$e=Object(o.a)(Ze,2),et=$e[0],tt=$e[1],at=Object(l.useState)(null),nt=Object(o.a)(at,2),ct=nt[0],st=nt[1],rt=Object(l.useState)(!1),ot=Object(o.a)(rt,2),lt=ot[0],it=ot[1],dt=Object(l.useState)(!1),ut=Object(o.a)(dt,2),jt=ut[0],bt=ut[1],ht=Object(l.useState)(null),Ot=Object(o.a)(ht,2),mt=Ot[0],ft=Ot[1],pt=Object(r.i)().url,gt=Object(r.h)(),xt=gt.short,vt=gt.full,wt=[{title:"Created at",dataIndex:"createdAt",render:function(e){var t=new Date(e);return Object(p.jsx)("p",{children:("00"+(t.getMonth()+1)).slice(-2)+"/"+("00"+t.getDate()).slice(-2)+"/"+t.getFullYear()+" "+("00"+t.getHours()).slice(-2)+":"+("00"+t.getMinutes()).slice(-2)+":"+("00"+t.getSeconds()).slice(-2)})}},{title:"Short URL",dataIndex:"short",render:function(e,t){var a=t.idx;return Object(p.jsxs)("p",{children:[Object(p.jsx)("a",{target:"_blank",rel:"noreferrer",onClick:function(){var e=Object(E.a)(b);e[a]=Object(k.a)(Object(k.a)({},e[a]),{},{clicks:e[a].clicks+1}),h(e)},href:window.location.href.split("glamurlshortenerapplication")[0]+e,children:e}),Object(p.jsx)("span",{className:"copy-button-list",onClick:function(){var t=document.createElement("input");document.body.appendChild(t),t.value=window.location.href.split("glamurlshortenerapplication")[0]+e,t.select(),document.execCommand("copy",!1),t.remove(),J("Copied")},children:"Copy"})]})}},{title:"Long URL",dataIndex:"full",render:function(e,t){var a=t.idx,n=t.key,c=t.short;return Object(p.jsxs)("p",{children:[Object(p.jsx)("a",{target:"_blank",rel:"noreferrer",href:e,children:e.slice(0,50)+"..."}),Object(p.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"18px",cursor:"pointer"},onClick:function(){ft({key:n,idx:a,full:e,short:c}),bt(!0)},children:"\u270e"})]})}},{title:"Clicks",dataIndex:"clicks",render:function(e,t){var a=t.short,n=t.full;return Object(p.jsxs)(s.b,{to:"".concat(pt,"/").concat(a,"/").concat(n.replace(/\//g,"-")),children:[e," \ud83d\udcc8"]})}},{title:"Protected",dataIndex:"password",render:function(e){return e?Object(p.jsx)("p",{style:{cursor:"pointer"},onClick:function(){return P((function(e){return!e}))},children:R?e:Object(p.jsx)("span",{children:"\ud83d\udd12"})}):Object(p.jsx)("h3",{children:"--"})}},{title:"Status",dataIndex:"status",render:function(e){return e?Object(p.jsx)("p",{children:"Enabled"}):Object(p.jsx)("p",{children:"Disabled"})}}];i&&wt.splice(1,0,{title:"Created By",dataIndex:"user"}),Object(l.useEffect)((function(){Me(1),G([])}),[i]),Object(l.useEffect)((function(){xt&&vt?(Xe({short:xt,full:vt.replace(/-/g,"/")}),tt(null),st(null)):(Xe(null),tt(null),st(null))}),[xt,vt]),Object(l.useEffect)((function(){var e=i?"/api/url/admin":"/api/url";y(!0),u.a.post(e,{accessToken:a,username:t,pageNumber:Ue,search:Ee,sort:We,filter:Ve,pageSize:Ye}).then((function(e){var a=[];e.data.shortUrls.forEach((function(e,t){var n=e.short,c=e.full,s=e.clicks,r=e._id,o=e.password,l=e.createdAt,i=e.status,d=e.user;a.push({short:n,full:c,clicks:s,key:r,password:o,createdAt:l,status:i,idx:t,user:d})})),h(a),y(!1);var c=i?"/api/url/admin/shortUrls/count/".concat(t):"/api/url/shortUrls/count/".concat(t);u.a.get(c).then((function(e){var t=e.data.count;return B(t)})).catch((function(e){var t;(console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?n(e.response.data.message):n("Something went wrong! :("))}))})).catch((function(e){var t;(console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?n(e.response.data.message):n("Something went wrong! :("))}))}),[t,a,n,Ue,Ee,Ve,We,g,Ye,i]),Object(l.useEffect)((function(){var e=setTimeout((function(){Ce(Ae),Me(1)}),1e3);return function(){return clearTimeout(e)}}),[Ae]),Object(l.useEffect)((function(){it(!!Qe)}),[Qe]);var St=function(e){Oe(!0),e?(ge(!0),ue(!0)):(Se(!0),oe(!0));var c=[];K.forEach((function(t){b.find((function(e){return e.key===t})).status!==e&&c.push(t)})),u.a.patch("/api/url/shortUrls",{accessToken:a,username:t,ids:c,status:e}).then((function(){J(e?"Enabled":"Disabled"),oe(!1),Oe(!1),G([]),e?(ge(!1),ue(!1)):(Se(!1),oe(!1));var t=Object(E.a)(b);t=t.map((function(t){return c.some((function(e){return t.key===e}))?Object(k.a)(Object(k.a)({},t),{},{status:e}):t})),h(t)})).catch((function(t){var a;(G([]),oe(!1),Oe(!1),e?(ge(!1),ue(!1)):(Se(!1),oe(!1)),console.log(t),t.response)&&((null===(a=t.response.data)||void 0===a?void 0:a.message)?n(t.response.data.message):n("Something went wrong! :("))}))},yt={selectedRowKeys:K,onChange:function(e){return G(e)},preserveSelectedRowKeys:!1},kt=K.length>0;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(V,{isModalVisible:lt,modalInfo:Qe,setModalInfo:Xe,modalStartDate:et,setModalStartDate:tt,modalEndDate:ct,setModalEndDate:st,setError:n,mobileMode:c,Admin:i}),Object(p.jsx)(q,{isModalVisible:jt,setIsModalVisible:bt,modalInfo:mt,setError:n,urls:b,setUrls:h,accessToken:a,username:t}),Object(p.jsxs)("div",{className:"list-container",children:[Object(p.jsxs)("p",{children:["Table of links generated by ",i?"others":"you"]}),Object(p.jsxs)("div",{children:[Object(p.jsxs)("div",{style:{marginBottom:"1rem"},children:[Object(p.jsx)(L.a,{title:"Are you sure to delete selected URLs?",onCancel:function(){$(!0),ge(!0),Se(!0);var e=[];K.forEach((function(t){e.push(t)})),u.a.delete("/api/url/shortUrls",{data:{accessToken:a,username:t,ids:e}}).then((function(){J("Deleted"),$(!1),ge(!1),Se(!1),Me(1),G([]),x((function(e){return!e}))})).catch((function(e){var t;(G([]),$(!1),ge(!1),Se(!1),x((function(e){return!e})),console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?n(e.response.data.message):n("Something went wrong! :("))}))},okText:"Cancel",cancelText:"Delete",children:Object(p.jsx)(f.a,{style:{marginRight:"0.5rem"},type:"danger",disabled:!kt||he,loading:Z,children:"Delete"})}),"  ",Object(p.jsx)(L.a,{title:"Are you sure to disable selected URLs?",onCancel:function(){return St(!1)},okText:"Cancel",cancelText:"Disable",children:Object(p.jsx)(f.a,{style:{marginLeft:"0.5rem",marginRight:"0.5rem"},type:"danger",disabled:!kt||pe,loading:re,children:"Disable"})}),"  ",Object(p.jsx)(L.a,{title:"Are you sure to enable selected URLs?",onCancel:function(){return St(!0)},okText:"Cancel",cancelText:"Enable",children:Object(p.jsx)(f.a,{style:{marginLeft:"0.5rem"},type:"primary",disabled:!kt||we,loading:de,children:"Enable"})}),Object(p.jsx)("span",{style:{marginLeft:8,position:"relative",top:"5px"},children:kt?"Selected ".concat(K.length," items"):""})]}),Object(p.jsx)("div",{children:Object(p.jsx)(T.a,{placeholder:"Search....",value:Ae,onChange:function(e){return Ie(e.target.value)}})}),Object(p.jsxs)("div",{children:[Object(p.jsx)(A.a,{title:"Sort by",children:Object(p.jsxs)(C.a,{value:We,onChange:function(e){Me(1),Fe(e)},children:[Object(p.jsx)(H,{value:"latest",children:"Latest"}),Object(p.jsx)(H,{value:"oldest",children:"Oldest"}),Object(p.jsx)(H,{value:"mostclicked",children:"Most clicked"}),Object(p.jsx)(H,{value:"leastclicked",children:"Least clicked"})]})}),Object(p.jsx)(A.a,{title:"Link enabled/disabled filter",children:Object(p.jsxs)(I.a.Group,{onChange:function(e){Me(1),qe(e.target.value)},value:Ve,children:[Object(p.jsx)(I.a,{value:1,children:"Enabled"}),Object(p.jsx)(I.a,{value:2,children:"Disabled"}),Object(p.jsx)(I.a,{value:3,children:"Both"})]})})]}),Object(p.jsx)(f.a,{type:"primary",disabled:1===Ue&&10===Ye&&"latest"===We&&3===Ve,onClick:function(){Me(1),_e(10),Fe("latest"),qe(3)},children:"Reset defaults"})]}),S?Object(p.jsx)("div",{style:{marginTop:"2rem"},children:Object(p.jsx)(D.a,{})}):Object(p.jsx)(N.a,{rowSelection:yt,columns:wt,dataSource:b,scroll:{x:1e3},pagination:{current:Ue,total:z,onChange:Me,position:["topRight"],onShowSizeChange:_e}}),z>0?Object(p.jsx)(L.a,{title:"Are you sure to delete all URLs generated by you?",onCancel:function(){ne(!0);var e=i?"/api/url/admin/shortUrls/all":"/api/url/shortUrls/all";u.a.delete(e,{data:{accessToken:a,username:t}}).then((function(){h([]),B(0),$(!1),Me(1),x((function(e){return!e}))})).catch((function(e){var t;(ne(!1),console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?n(e.response.data.message):n("Something went wrong! :("))}))},okText:"Cancel",cancelText:"Delete",children:Object(p.jsxs)(f.a,{style:{margin:"1rem 0"},type:"danger",loading:ae,children:["Delete all ",z," links generated by"," ",i?"other users":"you"]})}):null]})]})},X={appId:"130be11a-3569-49d1-a34e-8f5ea8d71e65",redirectUri:window.location.href.split("glamurlshortenerapplication")[0],scopes:["user.read"],authority:"https://login.microsoftonline.com/".concat("7c3e4bc5-2339-4622-8feb-47d86d4b5c90")},Z=Object(r.j)((function(e){var t=e.location,a=null,n=Object(l.useState)("home"),c=Object(o.a)(n,2),i=c[0],d=c[1],O=Object(l.useState)(!0),f=Object(o.a)(O,2),x=f[0],v=f[1],w=Object(l.useState)(!1),S=Object(o.a)(w,2),k=S[0],E=S[1],C=Object(l.useState)(!1),L=Object(o.a)(C,2),T=L[0],A=L[1],I=Object(l.useState)(!1),D=Object(o.a)(I,2),N=D[0],U=D[1],M=Object(l.useState)(null),R=Object(o.a)(M,2),P=R[0],Y=R[1],_=Object(l.useState)(null),z=Object(o.a)(_,2),B=z[0],W=z[1],F=Object(l.useState)(null),K=Object(o.a)(F,2),G=K[0],V=K[1],q=Object(l.useState)(null),H=Object(o.a)(q,2),J=H[0],Z=H[1],$=Object(l.useState)(null),ee=Object(o.a)($,2),te=ee[0],ae=ee[1],ne=Object(r.i)(),ce=ne.path,se=ne.url,re=Object(r.g)();Object(l.useEffect)((function(){var e=t.pathname.split("/");2===e.length?d("home"):"about"===e[2]?d("about"):"links"===e[2]?d("links"):"admin"===e[2]?d("admin"):d("home")}),[t]),Object(l.useEffect)((function(){localStorage.getItem("redirect")?t.pathname.length>28&&localStorage.setItem("redirect",t.pathname):localStorage.setItem("redirect",t.pathname),window.innerWidth<768?U(!0):U(!1);var e=window.addEventListener("resize",(function(){window.innerWidth<768?U(!0):U(!1)})),a=localStorage.getItem("accesstoken"),n=localStorage.getItem("username"),c=localStorage.getItem("name");return a&&n&&c&&!k?u.a.post("/api/authenticate",{accessToken:a,username:n}).then((function(e){if(200===e.status){v(!0),e.data.admin&&A(!0),Y(c),W(a),V(n),E(!0);var t=localStorage.getItem("redirect");t&&(re.push(t),localStorage.removeItem("redirect"))}else Z("Something went wrong! :(")})).catch((function(e){var t,a;(k||(v(!1),Y(null),W(null),V(null),E(!0),A(!1),ae(null)),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?Z(e.response.data.message):e.response&&((null===(a=e.response.data)||void 0===a?void 0:a.message)?Z(e.response.data.message):Z("Something went wrong! :(")));console.log(e)})):k||(v(!1),Y(null),W(null),V(null),E(!0),A(!1),ae(null)),function(){window.removeEventListener("resize",e)}}),[x,t,k,re]),Object(l.useEffect)((function(){var e;J&&(e=J,j.b.error(e),Z(null))}),[J]);var oe=new h.a({auth:{clientId:X.appId,redirectUri:X.redirectUri,authority:X.authority}}),le=function(){try{oe.logoutPopup().then((function(){localStorage.removeItem("name"),localStorage.removeItem("accesstoken"),localStorage.removeItem("username"),localStorage.removeItem("redirect"),clearTimeout(a),Y(null),v(!1),E(!1),A(!1),W(null),V(null),ae(null),re.push("/glamurlshortenerapplication")}))}catch(t){var e;if(console.log(t),t.response)(null===(e=t.response.data)||void 0===e?void 0:e.message)?Z(t.response.data.message):Z("Something went wrong! :(")}};return Object(p.jsx)("div",{children:Object(p.jsxs)("div",{children:[Object(p.jsx)(g,{user:P,authenticated:x,login:function(){try{oe.loginPopup({scopes:X.scopes,prompt:"select_account"}).then((function(e){a=setTimeout(le,3599998),localStorage.setItem("name",e.account.name),localStorage.setItem("username",e.account.username),localStorage.setItem("accesstoken",e.idToken),E(!1)}))}catch(t){var e;if(console.log(t),t.response)(null===(e=t.response.data)||void 0===e?void 0:e.message)?Z(t.response.data.message):Z("Something went wrong! :(")}},logout:le}),Object(p.jsx)("div",{className:"menu-container",children:Object(p.jsxs)(b.a,{onClick:function(e){return d(e.key)},selectedKeys:[i],mode:"horizontal",style:{justifyContent:"center",width:"100%"},theme:"dark",children:[Object(p.jsx)(b.a.Item,{children:Object(p.jsx)(s.b,{to:se,children:"Home"})},"home"),Object(p.jsx)(b.a.Item,{children:Object(p.jsx)(s.b,{to:"".concat(se,"/about"),children:"About"})},"about"),x?Object(p.jsx)(b.a.Item,{children:Object(p.jsx)(s.b,{to:"".concat(se,"/links"),children:"Links"})},"links"):null,T?Object(p.jsx)(b.a.Item,{children:Object(p.jsx)(s.b,{to:"".concat(se,"/admin"),children:"Admin"})},"admin"):null]})}),Object(p.jsxs)(r.d,{children:[Object(p.jsx)(r.b,{exact:!0,path:ce,children:Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(y,{authenticated:x,accessToken:B,username:G,setError:Z,mobileMode:N,shortURL:te,setShortURL:ae}),te?Object(p.jsx)(m.a,{className:"qr-code-app",value:te}):null]})}),Object(p.jsx)(r.b,{exact:!0,path:"".concat(ce,"/about"),children:Object(p.jsxs)("div",{className:"app-about",children:["GLAM URL shortener is a minimalistic link shortening platform built specifically for Oxford GLAM by",Object(p.jsxs)("a",{target:"_blank",rel:"noreferrer",href:"https://www.cloudmantra.net",children:[" cloudmantra",Object(p.jsx)("sup",{children:"TM"})]})]})}),Object(p.jsx)(r.b,{path:"".concat(ce,"/links/:short?/:full?"),children:x?Object(p.jsx)(Q,{accessToken:B,username:G,setError:Z,mobileMode:N}):Object(p.jsx)(r.a,{to:ce})}),Object(p.jsx)(r.b,{path:"".concat(ce,"/admin/:short?/:full?"),children:x?T?Object(p.jsx)(Q,{accessToken:B,username:G,setError:Z,mobileMode:N,Admin:!0}):Object(p.jsx)(r.a,{to:"".concat(ce,"/links")}):Object(p.jsx)(r.a,{to:ce})})]})]})})})),$=function(){var e=Object(l.useState)("Redirecting..."),t=Object(o.a)(e,2),a=t[0],n=t[1],c=Object(l.useState)(!1),s=Object(o.a)(c,2),i=s[0],d=s[1],j=Object(l.useState)(""),b=Object(o.a)(j,2),h=b[0],O=b[1],m=Object(l.useState)({code:""}),g=Object(o.a)(m,1)[0],x=Object(r.h)().shortUrl;Object(l.useEffect)((function(){u.a.get("https://freegeoip.app/json/".concat(document.getElementById("gfg").innerText)).then((function(e){g.code=e.data.country_code,u.a.get("/api/url/short/".concat(x,"?referrer=").concat(document.referrer,"&location=").concat(e.data.country_code)).then((function(e){var t=e.data.shortUrl;"string"===typeof t&&"password protected"===t?d(!0):"string"===typeof t&&"disabled"===t?n("Link Disabled"):window.location.href=t.full})).catch((function(e){var t;(console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?n(e.response.data.message):n("Something went wrong! :("))}))})).catch((function(e){n("Something went wrong! :("),console.log(e)}))}),[x,g]);var v=function(e){var t=function(){u()({method:"POST",url:"/api/url/short/".concat(x,"?referrer=").concat(document.referrer,"&location=").concat(g.code),data:{password:h}}).then((function(e){var t=e.data.shortUrl;window.location.href=t.full})).catch((function(e){var t;(console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?n(e.response.data.message):n("Something went wrong! :("))}))};"Enter"===e.key?t():e.key||t()};return Object(p.jsxs)("div",{style:{width:"100vw",height:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[i?Object(p.jsx)("p",{style:{fontSize:"5vw",marginBottom:"2rem",color:"white",width:"90vw",height:"100px",backgroundColor:"rgb(62, 63, 58)",display:"flex",justifyContent:"center",alignItems:"center"},children:"GLAM URL Shortener"}):null,Object(p.jsx)("h1",{style:{marginBottom:"2rem",color:"rgb(62, 63, 58)"},children:a}),i?Object(p.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(p.jsx)("input",{style:{padding:"1rem 2rem",textAlign:"center",fontSize:"1rem"},placeholder:"Enter Password",value:h,onChange:function(e){var t=e.target.value;return O(t)},onKeyPress:v}),Object(p.jsx)(f.a,{type:"primary",style:{backgroundColor:"#29abe0",marginLeft:"1rem",width:"80px",height:"50px"},onClick:v,children:"Go"})]}):null]})};c.a.render(Object(p.jsx)(s.a,{children:Object(p.jsxs)(r.d,{children:[Object(p.jsx)(r.b,{exact:!0,path:"/",children:Object(p.jsx)(r.a,{to:"/glamurlshortenerapplication"})}),Object(p.jsx)(r.b,{path:"/glamurlshortenerapplication",component:Z}),Object(p.jsx)(r.b,{path:"/:shortUrl",component:$})]})}),document.getElementById("root"))}},[[496,1,2]]]);
//# sourceMappingURL=main.aea61f5e.chunk.js.map