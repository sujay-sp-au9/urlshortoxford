(this.webpackJsonpreact2=this.webpackJsonpreact2||[]).push([[0],{38:function(e,t,n){},39:function(e,t,n){},42:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},68:function(e,t,n){"use strict";n.r(t);var c=n(29),a=n.n(c),s=n(31),r=n(3),o=n(2),i=(n(38),n(1)),l=n.n(i),u=n(70),d=(n(39),n(0)),j=function(e){var t=e.logout,n=e.user;return Object(d.jsxs)("div",{className:"header",children:[Object(d.jsxs)("div",{children:[Object(d.jsx)("p",{children:"GLAM URL Shortener"}),Object(d.jsx)("p",{children:"ABOUT"})]}),Object(d.jsxs)("div",{children:[Object(d.jsxs)("p",{children:["Welcome ",n]}),Object(d.jsx)("button",{onClick:t,children:"Logout"})]})]})},h=n(17),b=n.n(h),O=n(30),f=(n(42),n(10)),p=n.n(f),m=(n(61),function(e){var t=e.passwordProtect,n=e.setPasswordProtect,c=e.password,a=e.setPassword,s=e.alias,r=e.setAlias,i=e.loading,u=e.aliasAllowed,j=e.setAliasAllowed,h=l.a.useState(s),b=Object(o.a)(h,2),O=b[0],f=b[1];return l.a.useEffect((function(){var e=setTimeout((function(){O.length>0?p.a.get("/api/short/".concat(O,"/exists")).then((function(e){e.data.exists?j(!1):(j(!0),r(O))})).catch((function(e){window.alert("Something went wrong"),console.log(e)})):(r(""),j(!0))}),1e3);return function(){clearTimeout(e)}}),[O,r,j]),Object(d.jsxs)("div",{className:"link-options",children:[Object(d.jsxs)("div",{className:"password-protect",children:[Object(d.jsxs)("label",{className:"container",children:["Public",Object(d.jsx)("input",{disabled:i,type:"radio",checked:!t,onChange:function(){a(""),n(!1)},name:"radio"}),Object(d.jsx)("span",{className:"checkmark"})]}),Object(d.jsxs)("label",{className:"container",children:["Secret",Object(d.jsx)("input",{disabled:i,type:"radio",checked:t,onChange:function(){return n(!0)},name:"radio"}),Object(d.jsx)("span",{className:"checkmark"})]})]}),t?Object(d.jsx)("input",{className:"app-input",style:{marginTop:"0px"},placeholder:"******** (required if secret is selected)",value:c,onChange:function(e){return a(e.target.value)}}):null,Object(d.jsxs)("div",{className:"alias",children:[Object(d.jsx)("label",{children:window.location.href}),Object(d.jsx)("input",{className:"app-input",placeholder:"custom alias (optional)",value:O,onChange:function(e){return f(e.target.value)}}),O.length>0?Object(d.jsx)("span",{className:u?"available":"notavailable",children:u?"Available":"Not available"}):null]})]})}),w=function(e){var t=e.idToken,n=e.username,c=Object(i.useState)(!0),a=Object(o.a)(c,2),s=a[0],r=a[1],u=Object(i.useState)(null),j=Object(o.a)(u,2),h=j[0],f=j[1],w=Object(i.useState)(!1),x=Object(o.a)(w,2),g=x[0],v=x[1],k=Object(i.useState)(!1),S=Object(o.a)(k,2),y=S[0],N=S[1],A=Object(i.useState)(""),L=Object(o.a)(A,2),U=L[0],T=L[1],P=Object(i.useState)(!1),C=Object(o.a)(P,2),R=C[0],E=C[1],_=Object(i.useState)(!1),I=Object(o.a)(_,2),D=I[0],z=I[1],B=Object(i.useState)(""),G=Object(o.a)(B,2),q=G[0],F=G[1],J=Object(i.useState)(""),M=Object(o.a)(J,2),W=M[0],K=M[1],X=Object(i.useState)(!0),H=Object(o.a)(X,2),Q=H[0],V=H[1],Y=function(){var e=Object(O.a)(b.a.mark((function e(c){var a,s,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.preventDefault(),N(!0),v(!0),r(!0),e.prev=4,e.next=7,p()({method:"POST",url:"/api/shortUrls",data:{full:U,password:q.length>0?q:void 0,short:W.length>0?W:void 0,idToken:t,username:n}});case 7:a=e.sent,console.log(a),201===a.status||200===a.status?(s=a.data.shortUrl.short,f(window.location.href+s),T(""),E(!1),z(!1),F(""),K("")):("shortURL already exists"===(o=a.data.error)?(window.alert("Alias is already in use"),K("")):window.alert(o),r(!1)),N(!1),v(!1),e.next=21;break;case 14:e.prev=14,e.t0=e.catch(4),window.alert("Something went wrong!"),r(!1),N(!1),v(!1),console.log(e.t0);case 21:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(t){return e.apply(this,arguments)}}();return l.a.useEffect((function(){U.length>0&&/(([\w]+:)?\/\/)?(([\d\w]|%[a-fA-f\d]{2,2})+(:([\d\w]|%[a-fA-f\d]{2,2})+)?@)?([\d\w][-\d\w]{0,253}[\d\w]\.)+[\w]{2,63}(:[\d]+)?(\/([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)*(\?(&?([-+_~.\d\w]|%[a-fA-f\d]{2,2})=?)*)?(#([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)?/.test(U)?R?D?q.length>0&&Q?r(!1):r(!0):r(!Q):r(!1):r(!0)}),[U,R,D,q,Q]),Object(d.jsxs)("div",{className:"main",children:[Object(d.jsx)("p",{children:"GLAM URL Shortener"}),h?Object(d.jsxs)("div",{children:[Object(d.jsx)("span",{style:{marginRight:"0.5rem"},children:"Short URL is "}),Object(d.jsx)("a",{target:"_blank",rel:"noreferrer",href:h,className:"short-url",children:h})]}):null,Object(d.jsx)("div",{className:"loader",style:{display:y?"block":"none"},children:Object(d.jsx)("div",{className:"loading"})}),Object(d.jsxs)("form",{onSubmit:Y,children:[Object(d.jsx)("input",{className:"url-input",placeholder:"http(s)://",value:U,onChange:function(e){return T(e.target.value)}}),R?Object(d.jsx)(m,{passwordProtect:D,setPasswordProtect:z,password:q,setPassword:F,alias:W,setAlias:K,loading:y,aliasAllowed:Q,setAliasAllowed:V}):null,Object(d.jsxs)("div",{className:"form-buttons",children:[Object(d.jsx)("button",{type:"submit",disabled:s,children:"Shorten"}),Object(d.jsx)("button",{type:"button",onClick:function(){return E((function(e){return!e}))},disabled:g,children:"Link Options"})]})]}),Object(d.jsx)("p",{style:{color:"#98978b",marginTop:"1rem",textAlign:"center"},children:"The shorten button will be anabled when all required fields are filled."}),Object(d.jsx)("p",{style:{color:"#98978b",marginTop:"1rem",textAlign:"center"},children:'Did you know you can change the URL ending by clicking on "Link Options"?'})]})},x=n(33),g=(n(62),function(e){var t=e.username,n=e.idToken,c=Object(i.useState)(null),a=Object(o.a)(c,2),s=a[0],r=a[1],l=Object(i.useState)(!1),u=Object(o.a)(l,2),j=u[0],h=u[1],b=Object(i.useState)([]),O=Object(o.a)(b,2),f=O[0],m=O[1],w=Object(i.useState)(!1),g=Object(o.a)(w,2),v=g[0],k=g[1];Object(i.useEffect)((function(){return r(window.addEventListener("resize",(function(){window.innerWidth<768?h(!0):h(!1)}))),function(){window.removeEventListener("resize",s)}}),[]),Object(i.useEffect)((function(){p.a.get("/api/".concat(t)).then((function(e){var t=[];e.data.shortUrls.forEach((function(e){var n=e.short,c=e.full,a=e.clicks,s=e._id;t.push({short:n,full:c,clicks:a,id:s})})),m(t)}))}),[t,v]);return Object(d.jsxs)("div",{className:"list-container",children:[Object(d.jsx)("p",{children:"List of all links generated by you"}),Object(d.jsx)("p",{onClick:function(){return k((function(e){return!e}))},children:"Refresh list"}),Object(d.jsxs)("div",{className:"list",children:[Object(d.jsxs)("div",{className:"list-item",children:[Object(d.jsx)("span",{className:"column-1",children:"Short URL"}),Object(d.jsx)("span",{className:"column-2",children:"FULL URL"}),Object(d.jsx)("span",{className:"column-3",children:"Clicks"})]}),0===f.length?Object(d.jsx)("div",{children:"'No data'"}):null,f.map((function(e,c){return Object(d.jsxs)("div",{className:"list-item",children:[Object(d.jsx)("a",{className:"column-1",target:"_blank",rel:"noreferrer",href:window.location.href+e.short,children:window.location.href+e.short}),Object(d.jsx)("a",{className:"column-2",target:"_blank",rel:"noreferrer",href:e.full,children:e.full.slice(0,j?35:50)+"..."}),Object(d.jsx)("span",{className:"column-3",children:e.clicks}),Object(d.jsx)("span",{onClick:function(){return function(e,c){window.confirm("Confirm delete ?")&&(p.a.delete("/api/short/".concat(e),{data:{idToken:n,username:t}}),m((function(e){var t=Object(x.a)(e);return t.splice(c,1),t})))}(e.id,c)},className:"column-4",children:"Delete"})]},e.id)}))]})]})}),v={appId:"d4da2439-fc78-49c7-a5d8-b3288224a42d",redirectUri:"https://shorturl.cloudmantra.in",scopes:["user.read"],authority:"https://login.microsoftonline.com/common"},k=function(){var e=null,t=Object(i.useState)(!1),n=Object(o.a)(t,2),c=n[0],a=n[1],s=Object(i.useState)(null),r=Object(o.a)(s,2),l=r[0],h=r[1],b=Object(i.useState)(null),O=Object(o.a)(b,2),f=O[0],p=O[1],m=Object(i.useState)(null),x=Object(o.a)(m,2),k=x[0],S=x[1],y=new u.a({auth:{clientId:v.appId,redirectUri:v.redirectUri,authority:v.authority},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}}),N=function(){try{y.logoutPopup().then((function(t){clearTimeout(e),h(null),a(!1)}))}catch(t){console.log(t),window.alert("Something went wrong! :(")}};return c?Object(d.jsxs)("div",{children:[Object(d.jsx)(j,{user:l,logout:N}),Object(d.jsx)(w,{idToken:f,username:k}),Object(d.jsx)(g,{idToken:f,username:k})]}):Object(d.jsxs)("div",{className:"login-page",children:[Object(d.jsxs)("h1",{children:["URL shortner",Object(d.jsx)("sup",{children:" powered by OXFORD"})]}),Object(d.jsx)("div",{className:"login-button",onClick:function(){try{y.loginPopup({scopes:v.scopes,prompt:"select_account"}).then((function(t){e=setTimeout(N,36e5),h(t.account.name),p(t.idToken),S(t.account.username),a(!0)}))}catch(t){console.log(t),window.alert("Something went wrong! :(")}},children:Object(d.jsx)("h3",{children:"Please log in"})})]})},S=function(){var e=Object(i.useState)("Redirecting..."),t=Object(o.a)(e,2),n=t[0],c=t[1],a=Object(i.useState)(!1),s=Object(o.a)(a,2),r=s[0],l=s[1],u=Object(i.useState)(""),j=Object(o.a)(u,2),h=j[0],b=j[1];Object(i.useEffect)((function(){p.a.get("/api/short/".concat(window.location.pathname.slice(1))).then((function(e){var t=e.data.shortUrl;"string"===typeof t?l(!0):window.location.href=t.full})).catch((function(e){console.log(e),c("Not found")}))}),[]);var O=function(e){var t=function(){p()({method:"POST",url:"/api/short/".concat(window.location.pathname.slice(1)),data:{password:h}}).then((function(e){var t=e.data.shortUrl;window.location.href=t.full})).catch((function(e){console.log(e),c("Not found or Password incorrect")}))};"Enter"===e.key?t():e.key||t()};return Object(d.jsxs)("div",{style:{width:"100vw",height:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[Object(d.jsx)("h1",{style:{marginBottom:"2rem"},children:n}),r?Object(d.jsxs)("div",{style:{display:"flex"},children:[Object(d.jsx)("input",{style:{padding:"1rem 2rem",textAlign:"center",fontSize:"1rem"},placeholder:"Enter Password",value:h,onChange:function(e){var t=e.target.value;return b(t)},onKeyPress:O}),Object(d.jsx)("span",{style:{marginLeft:"1rem",cursor:"pointer"},onClick:O,children:"Go"})]}):null]})};a.a.render(Object(d.jsx)(s.a,{children:Object(d.jsxs)(r.c,{children:[Object(d.jsx)(r.a,{exact:!0,path:"/",component:k}),Object(d.jsx)(r.a,{path:"/:shortUrl",component:S})]})}),document.getElementById("root"))}},[[68,1,2]]]);
//# sourceMappingURL=main.53a2c67b.chunk.js.map