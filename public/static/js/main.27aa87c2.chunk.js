(this.webpackJsonpreact2=this.webpackJsonpreact2||[]).push([[0],{39:function(e,t,n){},40:function(e,t,n){},43:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},69:function(e,t,n){"use strict";n.r(t);var c=n(31),s=n.n(c),a=n(33),r=n(3),o=n(2),i=(n(39),n(1)),l=n.n(i),d=n(71),u=(n(40),n(0)),j=function(e){var t=e.logout,n=e.user,c=e.login,s=e.authenticated;return Object(u.jsxs)("div",{className:"header",children:[Object(u.jsxs)("div",{children:[Object(u.jsx)("a",{href:"/",children:"GLAM URL Shortener"}),Object(u.jsx)("p",{children:"powered by MongoDB"})]}),Object(u.jsx)("div",{className:s?"":"fix-view-div",children:s?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("p",{children:["Welcome ",n]}),Object(u.jsx)("button",{className:"logout-button",onClick:t,children:"Sign out"})]}):Object(u.jsx)("button",{className:"login-button fix-view-button",onClick:c,children:"Sign in with Azure"})})]})},h=n(17),b=n.n(h),O=n(32),f=(n(43),n(10)),m=n.n(f),p=(n(62),function(e){var t=e.passwordProtect,n=e.setPasswordProtect,c=e.password,s=e.setPassword,a=e.alias,r=e.setAlias,i=e.loading,d=e.aliasAllowed,j=e.setAliasAllowed,h=e.passwordError,b=e.aliasError,O=e.passwordTouched,f=e.setPasswordTouched,p=e.setError,x=l.a.useState(a),w=Object(o.a)(x,2),g=w[0],v=w[1];return l.a.useEffect((function(){var e=setTimeout((function(){g.length>0?m.a.get("/api/short/".concat(g,"/exists")).then((function(e){e.data.exists?j(!1):(j(!0),r(g))})).catch((function(e){p("Something went wrong"),console.log(e)})):(r(""),j(!0))}),1e3);return function(){clearTimeout(e)}}),[g,r,j,p]),Object(u.jsxs)("div",{className:"link-options",children:[Object(u.jsx)("p",{children:"Customize link"}),Object(u.jsxs)("div",{className:"password-protect",children:[Object(u.jsxs)("label",{className:"container",children:[Object(u.jsx)("div",{className:t?"not-selected":"selected",children:"Public"}),Object(u.jsx)("input",{disabled:i,type:"radio",checked:!t,onChange:function(){s(""),f(!1),n(!1)},name:"radio"}),Object(u.jsx)("span",{className:"checkmark"})]}),Object(u.jsxs)("label",{className:"container",children:[Object(u.jsx)("div",{className:t?"selected":"not-selected",children:"Secret"}),Object(u.jsx)("input",{disabled:i,type:"radio",checked:t,onChange:function(){return n(!0)},name:"radio"}),Object(u.jsx)("span",{className:"checkmark"})]})]}),t?Object(u.jsx)("input",{className:"app-input ".concat(h?"error":""),style:{marginTop:"0px"},placeholder:"******** (required if secret is selected)",value:c,onClick:function(){return f(!0)},onChange:function(e){O||f(!0),s(e.target.value)}}):null,Object(u.jsxs)("div",{className:"alias",children:[Object(u.jsx)("label",{children:window.location.href}),Object(u.jsx)("input",{className:"app-input ".concat(b?"error":""),placeholder:"custom alias (optional)",value:g,onChange:function(e){return v(e.target.value)}}),g.length>0?Object(u.jsx)("span",{className:d?"available":"notavailable",children:d?"Available":"Not available"}):null]})]})}),x=function(e){var t=e.idToken,n=e.username,c=e.authenticated,s=e.setError,a=e.mobileMode,r=e.shortURL,d=e.setShortURL,j=Object(i.useState)(!0),h=Object(o.a)(j,2),f=h[0],x=h[1],w=Object(i.useState)(!1),g=Object(o.a)(w,2),v=g[0],k=g[1],S=Object(i.useState)(!1),y=Object(o.a)(S,2),N=y[0],C=y[1],L=Object(i.useState)(""),U=Object(o.a)(L,2),E=U[0],T=U[1],A=Object(i.useState)(!1),P=Object(o.a)(A,2),R=P[0],M=P[1],_=Object(i.useState)(!1),I=Object(o.a)(_,2),z=I[0],D=I[1],B=Object(i.useState)(""),G=Object(o.a)(B,2),W=G[0],F=G[1],J=Object(i.useState)(""),q=Object(o.a)(J,2),K=q[0],Y=q[1],H=Object(i.useState)(!0),Q=Object(o.a)(H,2),V=Q[0],X=Q[1],Z=Object(i.useState)(!1),$=Object(o.a)(Z,2),ee=$[0],te=$[1],ne=Object(i.useState)(!1),ce=Object(o.a)(ne,2),se=ce[0],ae=ce[1],re=Object(i.useState)(!1),oe=Object(o.a)(re,2),ie=oe[0],le=oe[1],de=Object(i.useState)(!1),ue=Object(o.a)(de,2),je=ue[0],he=ue[1],be=Object(i.useState)(!1),Oe=Object(o.a)(be,2),fe=Oe[0],me=Oe[1],pe=Object(i.useState)("Copy"),xe=Object(o.a)(pe,2),we=xe[0],ge=xe[1],ve=function(){var e=Object(O.a)(b.a.mark((function e(a){var r,o,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),c){e.next=4;break}return s("Please login to shorten URL"),e.abrupt("return");case 4:if(!f){e.next=7;break}return ke(),e.abrupt("return");case 7:return C(!0),k(!0),x(!0),e.prev=10,e.next=13,m()({method:"POST",url:"/api/shortUrls",data:{full:E,password:W.length>0?W:void 0,short:K.length>0?K:void 0,idToken:t,username:n}});case 13:r=e.sent,console.log(r),201===r.status||200===r.status?(o=r.data.shortUrl.short,ge("Copy"),d(window.location.href+o),T(""),M(!1),D(!1),F(""),Y(""),X(!0),te(!1),ae(!1),le(!1),he(!1),me(!1)):("shortURL already exists"===(i=r.data.error)?(s("Alias is already in use"),Y("")):s(i),x(!1)),C(!1),k(!1),e.next=27;break;case 20:e.prev=20,e.t0=e.catch(10),s("Something went wrong"),x(!1),C(!1),k(!1),console.log(e.t0);case 27:case"end":return e.stop()}}),e,null,[[10,20]])})));return function(t){return e.apply(this,arguments)}}(),ke=function(){0===E.length&&le(!0),R&&(z&&0===W.length&&he(!0),K.length>0&&(V||me(!0)))};return l.a.useEffect((function(){E.length>0&&/(([\w]+:)?\/\/)?(([\d\w]|%[a-fA-f\d]{2,2})+(:([\d\w]|%[a-fA-f\d]{2,2})+)?@)?([\d\w][-\d\w]{0,253}[\d\w]\.)+[\w]{2,63}(:[\d]+)?(\/([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)*(\?(&?([-+_~.\d\w]|%[a-fA-f\d]{2,2})=?)*)?(#([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)?/.test(E)?(le(!1),R?z?W.length>0&&V?(he(!1),me(!1),x(!1)):(0===W.length&&se&&he(!0),V||me(!0),x(!0)):V?(he(!1),me(!1),x(!1)):(me(!0),x(!0)):(he(!1),me(!1),x(!1))):(ee&&le(!0),x(!0))}),[E,R,z,W,V,se,ee]),Object(u.jsxs)("div",{className:"main",children:[Object(u.jsx)("p",{children:"GLAM URL Shortener"}),r?Object(u.jsxs)("div",{className:"short-url",children:[Object(u.jsx)("span",{style:{marginRight:"0.5rem"},children:"Short URL is "}),Object(u.jsx)("a",{style:{wordBreak:"break-all"},target:"_blank",rel:"noreferrer",href:r,children:a?r.slice(0,30)+"...":r}),Object(u.jsx)("span",{className:"copy-button",onClick:function(){var e=document.createElement("input");document.body.appendChild(e),e.value=r,e.select(),document.execCommand("copy",!1),e.remove(),ge("Copied")},children:we})]}):null,Object(u.jsx)("div",{className:"loader",style:{display:N?"block":"none"},children:Object(u.jsx)("div",{className:"loading"})}),Object(u.jsxs)("form",{onSubmit:ve,children:[Object(u.jsx)("input",{className:"url-input ".concat(ie?"error":""),placeholder:"http(s)://",value:E,onClick:function(){return te(!0)},onChange:function(e){ee||te(!0),T(e.target.value)}}),R?Object(u.jsx)(p,{passwordProtect:z,setPasswordProtect:D,password:W,setPassword:F,alias:K,setAlias:Y,loading:N,aliasAllowed:V,setAliasAllowed:X,passwordError:je,aliasError:fe,passwordTouched:se,setPasswordTouched:ae,setError:s}):null,Object(u.jsxs)("div",{className:"form-buttons",children:[Object(u.jsx)("button",{type:"submit",className:f?"disabled":"",children:"Shorten"}),Object(u.jsx)("button",{type:"button",onClick:function(){v||M((function(e){return!e}))},className:v?"disabled":"",children:"Link Options"})]})]}),Object(u.jsx)("p",{style:{color:"#98978b",marginTop:"1rem",textAlign:"center"},children:'Did you know you can change the URL ending by clicking on "Link Options"?'})]})},w=n(21),g=n(20),v=(n(63),function(e){var t=e.username,n=e.idToken,c=e.mobileMode,s=e.shortURL,a=e.setError,r=Object(i.useState)([]),l=Object(o.a)(r,2),d=l[0],j=l[1],h=Object(i.useState)(!1),b=Object(o.a)(h,2),O=b[0],f=b[1];Object(i.useEffect)((function(){m.a.post("/api",{idToken:n,username:t}).then((function(e){var t=[];e.data.shortUrls.forEach((function(e){var n=e.short,c=e.full,s=e.clicks,a=e._id,r=e.password;t.push({short:n,full:c,clicks:s,id:a,password:!!r})})),j(t)})).catch((function(e){console.log(e),a("Something went wrong")}))}),[t,O,n,a]),Object(i.useEffect)((function(){f((function(e){return!e}))}),[s]);return Object(u.jsxs)("div",{className:"list-container",children:[Object(u.jsx)("p",{children:"Your last 5 links generated"}),Object(u.jsx)("div",{className:"list",children:0===d.length?Object(u.jsx)("div",{style:{marginTop:"1rem"},children:"'No data'"}):Object(u.jsxs)("table",{children:[Object(u.jsxs)("tr",{children:[Object(u.jsx)("th",{children:"Short URL"}),Object(u.jsx)("th",{children:"FULL URL"}),Object(u.jsx)("th",{children:"Clicks"})]}),d.map((function(e,s){return Object(u.jsxs)("tr",{children:[Object(u.jsx)("td",{children:Object(u.jsx)("a",{className:"column-1",target:"_blank",rel:"noreferrer",href:window.location.href+e.short,onClick:function(){var e=Object(g.a)(d);e[s]=Object(w.a)(Object(w.a)({},e[s]),{},{clicks:e[s].clicks+1}),j(e)},children:(window.location.href+e.short).slice(0,c?35:50)+"..."})}),Object(u.jsx)("td",{children:Object(u.jsx)("a",{className:"column-2",target:"_blank",rel:"noreferrer nofollow",href:e.full,children:e.full.slice(0,c?35:50)+"..."})}),Object(u.jsx)("td",{className:"td-clicks",children:e.clicks}),Object(u.jsx)("td",{onClick:function(){return function(e,c){window.confirm("Confirm delete ?")&&m.a.delete("/api/short/".concat(e),{data:{idToken:n,username:t}}).then((function(e){return j((function(e){var t=Object(g.a)(e);return t.splice(c,1),t}))})).catch((function(e){console.log(e),a("Something went wrong")}))}(e.id,s)},children:Object(u.jsx)("p",{className:"td-delete",children:"Delete"})}),e.password?Object(u.jsx)("td",{children:"\ud83d\udd12"}):null]})}))]})}),d.length>0?Object(u.jsx)("p",{className:"delete-all",onClick:function(){window.confirm("Confirm delete ALL?")&&m.a.delete("/api/shortUrls",{data:{idToken:n,username:t}}).then((function(){return j([])})).catch((function(e){console.log(e),a("Something went wrong")}))},children:"Delete ALL links"}):null]})}),k={appId:"d4da2439-fc78-49c7-a5d8-b3288224a42d",redirectUri:"https://shorturl.cloudmantra.in",scopes:["user.read"],authority:"https://login.microsoftonline.com/common"},S=function(){var e=null,t=Object(i.useState)(!1),n=Object(o.a)(t,2),c=n[0],s=n[1],a=Object(i.useState)(!1),r=Object(o.a)(a,2),l=r[0],h=r[1],b=Object(i.useState)(null),O=Object(o.a)(b,2),f=O[0],m=O[1],p=Object(i.useState)(null),w=Object(o.a)(p,2),g=w[0],S=w[1],y=Object(i.useState)(null),N=Object(o.a)(y,2),C=N[0],L=N[1],U=Object(i.useState)(null),E=Object(o.a)(U,2),T=E[0],A=E[1],P=Object(i.useState)(null),R=Object(o.a)(P,2),M=R[0],_=R[1];Object(i.useEffect)((function(){window.innerWidth<768?h(!0):h(!1);var e=window.addEventListener("resize",(function(){window.innerWidth<768?h(!0):h(!1)}));return function(){window.removeEventListener("resize",e)}}),[]),Object(i.useEffect)((function(){var e;return T&&(e=setTimeout((function(){A(null)}),2e3)),function(){clearTimeout(e)}}),[T]);var I=new d.a({auth:{clientId:k.appId,redirectUri:k.redirectUri,authority:k.authority}}),z=function(){try{I.logoutPopup().then((function(t){clearTimeout(e),m(null),s(!1)}))}catch(t){console.log(t),A("Something went wrong! :(")}};return Object(u.jsxs)("div",{children:[T?Object(u.jsx)("div",{className:"alert",children:Object(u.jsx)("strong",{children:T})}):null,Object(u.jsxs)("div",{className:T?"blur":"",children:[Object(u.jsx)(j,{user:f,authenticated:c,login:function(){try{I.loginPopup({scopes:k.scopes,prompt:"select_account"}).then((function(t){e=setTimeout(z,36e5),m(t.account.name),S(t.idToken),L(t.account.username),s(!0)}))}catch(t){console.log(t),A("Something went wrong! :(")}},logout:z}),Object(u.jsx)(x,{authenticated:c,idToken:g,username:C,setError:A,mobileMode:l,shortURL:M,setShortURL:_}),c?Object(u.jsx)(v,{idToken:g,username:C,mobileMode:l,shortURL:M,setError:A}):null]})]})},y=function(){var e=Object(i.useState)("Redirecting..."),t=Object(o.a)(e,2),n=t[0],c=t[1],s=Object(i.useState)(!1),a=Object(o.a)(s,2),r=a[0],l=a[1],d=Object(i.useState)(""),j=Object(o.a)(d,2),h=j[0],b=j[1];Object(i.useEffect)((function(){m.a.get("/api/short/".concat(window.location.pathname.slice(1))).then((function(e){var t=e.data.shortUrl;"string"===typeof t?l(!0):window.location.href=t.full})).catch((function(e){console.log(e),c("Not found")}))}),[]);var O=function(e){var t=function(){m()({method:"POST",url:"/api/short/".concat(window.location.pathname.slice(1)),data:{password:h}}).then((function(e){var t=e.data.shortUrl;window.location.href=t.full})).catch((function(e){console.log(e),c("Not found or Password incorrect")}))};"Enter"===e.key?t():e.key||t()};return Object(u.jsxs)("div",{style:{width:"100vw",height:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[Object(u.jsx)("p",{style:{fontSize:"5vw",marginBottom:"2rem",color:"white",width:"90vw",height:"100px",backgroundColor:"rgb(62, 63, 58)",display:"flex",justifyContent:"center",alignItems:"center"},children:"GLAM URL Shortener"}),Object(u.jsx)("h1",{style:{marginBottom:"2rem",color:"rgb(62, 63, 58)"},children:n}),r?Object(u.jsxs)("div",{style:{display:"flex"},children:[Object(u.jsx)("input",{style:{padding:"1rem 2rem",textAlign:"center",fontSize:"1rem"},placeholder:"Enter Password",value:h,onChange:function(e){var t=e.target.value;return b(t)},onKeyPress:O}),Object(u.jsx)("span",{style:{marginLeft:"1rem",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center"},onClick:O,children:"Go"})]}):null]})};s.a.render(Object(u.jsx)(a.a,{children:Object(u.jsxs)(r.c,{children:[Object(u.jsx)(r.a,{exact:!0,path:"/",component:S}),Object(u.jsx)(r.a,{path:"/:shortUrl",component:y})]})}),document.getElementById("root"))}},[[69,1,2]]]);
//# sourceMappingURL=main.27aa87c2.chunk.js.map