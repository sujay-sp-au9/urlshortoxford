(this.webpackJsonpreact2=this.webpackJsonpreact2||[]).push([[0],{321:function(e,t,a){},348:function(e,t,a){},351:function(e,t,a){},352:function(e,t,a){},353:function(e,t,a){},354:function(e,t,a){},496:function(e,t,a){"use strict";a.r(t);var n=a(40),s=a.n(n),c=a(72),r=a(39),o=a(9),l=(a(321),a(0)),i=a.n(l),d=a(43),u=a.n(d),j=a(306),b=a(114),h=a(504),O=a(276),m=a.n(O),f=(a(348),a(44)),p=a(6),g=function(e){var t=e.logout,a=e.user,n=e.login,s=e.authenticated;return Object(p.jsxs)("div",{className:"header",children:[Object(p.jsx)("div",{children:Object(p.jsx)("p",{children:"GLAM URL Shortener"})}),Object(p.jsx)("div",{className:s?"":"fix-view-div",children:s?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("p",{children:["Welcome ",Object(p.jsx)("span",{className:"header-user-tab",children:a})]}),Object(p.jsx)(f.a,{className:"logout-button",onClick:t,children:"Sign out"})]}):Object(p.jsx)(f.a,{className:"login-button fix-view-button",onClick:n,children:"Sign in with AD"})})]})},x=a(131),v=a.n(x),w=a(278),S=(a(351),a(352),a(151)),k=function(e){var t=e.passwordProtect,a=e.setPasswordProtect,n=e.password,s=e.setPassword,c=e.alias,r=e.setAlias,l=e.expire,d=e.setExpire,j=e.loading,b=e.aliasAllowed,h=e.setAliasAllowed,O=e.passwordError,m=e.aliasError,f=e.passwordTouched,g=e.setPasswordTouched,x=e.setError,v=i.a.useState(c),w=Object(o.a)(v,2),k=w[0],y=w[1],E=i.a.useState("Available"),C=Object(o.a)(E,2),L=C[0],A=C[1];return i.a.useEffect((function(){if(k.length>0){if(k.startsWith("api"))return h(!1),void A("Not available");h(!1),A("Checking")}else h(!0);var e=setTimeout((function(){k.length>0?u.a.get("/api/url/short/".concat(k,"/exists")).then((function(e){e.data.exists?(h(!1),A("Not available")):(h(!0),r(k),A("Available"))})).catch((function(e){var t;e.response&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?x(e.response.data.message):x("Something went wrong! :("));r(""),y(""),h(!0),console.log(e)})):(r(""),h(!0))}),1e3);return function(){clearTimeout(e)}}),[k,r,h,x]),Object(p.jsxs)("div",{className:"link-options",children:[Object(p.jsxs)("div",{className:"password-protect",children:[Object(p.jsxs)("label",{className:"container",children:[Object(p.jsx)("div",{className:t?"not-selected":"selected",children:"Public"}),Object(p.jsx)("input",{disabled:j,type:"radio",checked:!t,onChange:function(){s(""),g(!1),a(!1)},name:"radio"}),Object(p.jsx)("span",{className:"checkmark"})]}),Object(p.jsxs)("label",{className:"container",children:[Object(p.jsx)("div",{className:t?"selected":"not-selected",children:"Secret"}),Object(p.jsx)("input",{disabled:j,type:"radio",checked:t,onChange:function(){return a(!0)},name:"radio"}),Object(p.jsx)("span",{className:"checkmark"})]})]}),t?Object(p.jsx)("input",{className:"app-input ".concat(O?"error":""),style:{marginTop:"0px",marginBottom:"1rem"},placeholder:"******** (required if secret is selected)",value:n,onClick:function(){return g(!0)},onChange:function(e){f||g(!0),s(e.target.value)}}):null,Object(p.jsxs)("div",{className:"alias",children:[Object(p.jsx)("label",{children:window.location.href.split("glamurlshortenerapplication")[0]}),Object(p.jsx)("input",{className:"app-input ".concat(m?"error":""),placeholder:"custom alias (optional)",value:k,onChange:function(e){return y(e.target.value)}}),k.length>0?Object(p.jsx)("span",{className:b?"available":"notavailable",children:L}):null]}),Object(p.jsx)("div",{children:Object(p.jsx)(S.a,{checked:l,onChange:function(e){return d(e.target.checked)},style:{fontSize:"16px",marginTop:"1rem"},children:"Auto expire in 7 days"})})]})},y=function(e){var t=e.accessToken,a=e.username,n=e.authenticated,s=e.setError,c=e.mobileMode,r=e.shortURL,i=e.setShortURL,d=Object(l.useState)(!0),j=Object(o.a)(d,2),b=j[0],h=j[1],O=Object(l.useState)(!1),m=Object(o.a)(O,2),g=m[0],x=m[1],S=Object(l.useState)(!1),y=Object(o.a)(S,2),E=y[0],C=y[1],L=Object(l.useState)(""),A=Object(o.a)(L,2),T=A[0],I=A[1],D=Object(l.useState)(!1),N=Object(o.a)(D,2),U=N[0],M=N[1],R=Object(l.useState)(!1),P=Object(o.a)(R,2),Y=P[0],_=P[1],z=Object(l.useState)(""),B=Object(o.a)(z,2),F=B[0],W=B[1],G=Object(l.useState)(""),K=Object(o.a)(G,2),V=K[0],q=K[1],H=Object(l.useState)(!0),J=Object(o.a)(H,2),Q=J[0],X=J[1],Z=Object(l.useState)(!1),$=Object(o.a)(Z,2),ee=$[0],te=$[1],ae=Object(l.useState)(!1),ne=Object(o.a)(ae,2),se=ne[0],ce=ne[1],re=Object(l.useState)(!1),oe=Object(o.a)(re,2),le=oe[0],ie=oe[1],de=Object(l.useState)(!1),ue=Object(o.a)(de,2),je=ue[0],be=ue[1],he=Object(l.useState)(!1),Oe=Object(o.a)(he,2),me=Oe[0],fe=Oe[1],pe=Object(l.useState)(!1),ge=Object(o.a)(pe,2),xe=ge[0],ve=ge[1],we=Object(l.useState)("Copy"),Se=Object(o.a)(we,2),ke=Se[0],ye=Se[1],Ee=function(){var e=Object(w.a)(v.a.mark((function e(c){var r,o,l,d,j;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.preventDefault(),n){e.next=4;break}return s("Please login to shorten URL"),e.abrupt("return");case 4:if(!b){e.next=7;break}return Ce(),e.abrupt("return");case 7:return C(!0),x(!0),h(!0),e.prev=10,r={full:T,password:F.length>0?F:void 0,short:V.length>0?V:void 0,accessToken:t,username:a},ee&&(r.state=!0),e.next=15,u()({method:"POST",url:"/api/url/shortUrls",data:r});case 15:201===(o=e.sent).status||200===o.status?(l=o.data.shortUrl.short,ye("Copy"),i(window.location.href.split("glamurlshortenerapplication")[0]+l),I(""),M(!1),_(!1),W(""),q(""),te(!1),X(!0),ce(!1),ie(!1),be(!1),fe(!1),ve(!1)):("shortURL already exists"===(d=o.data.error)?(s("Alias is already in use"),q("")):s(d),h(!1)),C(!1),x(!1),e.next=28;break;case 21:e.prev=21,e.t0=e.catch(10),e.t0.response&&((null===(j=e.t0.response.data)||void 0===j?void 0:j.message)?s(e.t0.response.data.message):s("Something went wrong! :(")),h(!1),C(!1),x(!1),console.log(e.t0);case 28:case"end":return e.stop()}}),e,null,[[10,21]])})));return function(t){return e.apply(this,arguments)}}(),Ce=function(){0===T.length&&be(!0),U&&(Y&&0===F.length&&fe(!0),V.length>0&&(Q||ve(!0)))};return Object(l.useEffect)((function(){T.length>0&&/(([\w]+:)?\/\/)?(([\d\w]|%[a-fA-f\d]{2,2})+(:([\d\w]|%[a-fA-f\d]{2,2})+)?@)?([\d\w][-\d\w]{0,253}[\d\w]\.)+[\w]{2,63}(:[\d]+)?(\/([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)*(\?(&?([-+_~.\d\w]|%[a-fA-f\d]{2,2})=?)*)?(#([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)?/.test(T)?(be(!1),U?Y?F.length>0&&Q?(fe(!1),ve(!1),h(!1)):(0===F.length&&le&&fe(!0),Q||ve(!0),h(!0)):Q?(fe(!1),ve(!1),h(!1)):(ve(!0),h(!0)):(fe(!1),ve(!1),h(!1))):(se&&be(!0),h(!0))}),[T,U,Y,F,Q,le,se]),Object(l.useEffect)((function(){n||(ye("Copy"),i(null),I(""),M(!1),_(!1),W(""),q(""),X(!0),ce(!1),ie(!1),be(!1),fe(!1),ve(!1))}),[n,i]),Object(l.useEffect)((function(){return function(){return i(null)}}),[i]),Object(p.jsxs)("div",{className:"main",children:[Object(p.jsx)("p",{children:"GLAM URL Shortener"}),r?Object(p.jsxs)("div",{className:"short-url",children:[Object(p.jsx)("span",{style:{marginRight:"0.5rem"},children:"Short URL is "}),Object(p.jsx)("a",{style:{wordBreak:"break-all"},target:"_blank",rel:"noreferrer",href:r,children:c?r.slice(0,30)+"...":r}),Object(p.jsx)("span",{className:"copy-button",onClick:function(){var e=document.createElement("input");document.body.appendChild(e),e.value=r,e.select(),document.execCommand("copy",!1),e.remove(),ye("Copied")},children:ke})]}):null,Object(p.jsx)("div",{className:"loader",style:{display:E?"block":"none"},children:Object(p.jsx)("div",{className:"loading"})}),Object(p.jsxs)("form",{onSubmit:Ee,children:[Object(p.jsx)("input",{className:"url-input ".concat(je?"error":""),placeholder:"http(s)://",value:T,onClick:function(){return ce(!0)},onChange:function(e){se||ce(!0),I(e.target.value)}}),U?Object(p.jsx)(k,{passwordProtect:Y,setPasswordProtect:_,password:F,setPassword:W,alias:V,setAlias:q,expire:ee,setExpire:te,loading:E,aliasAllowed:Q,setAliasAllowed:X,passwordError:me,aliasError:xe,passwordTouched:le,setPasswordTouched:ie,setError:s}):null,Object(p.jsxs)("div",{className:"form-buttons",children:[Object(p.jsx)(f.a,{type:"submit",className:b?"disabled":"",onClick:Ee,children:"Shorten"}),Object(p.jsx)("button",{type:"button",onClick:function(){g||M((function(e){return!e}))},className:g?"disabled":"",children:"Customize"})]})]})]})},E=a(156),C=a(150),L=(a(353),a(149)),A=a(511),T=a(507),I=a(130),D=a(187),N=a(505),U=(a(354),a(508)),M=a(506),R=a(93),P=a(500),Y=a(294),_=a(295),z=a(157),B=a(311),F=a(510),W=a(296),G=a(148),K=a(279),V=function(e){var t=e.isModalVisible,a=e.modalInfo,n=e.setModalInfo,s=e.modalStartDate,i=e.setModalStartDate,d=e.modalEndDate,j=e.setModalEndDate,b=e.setError,h=e.mobileMode,O=(e.Admin,Object(l.useState)([])),m=Object(o.a)(O,2),f=m[0],g=m[1],x=Object(l.useState)([]),v=Object(o.a)(x,2),w=v[0],S=v[1],k=Object(l.useState)([]),y=Object(o.a)(k,2),E=y[0],C=y[1],L=Object(l.useState)([]),A=Object(o.a)(L,2),T=A[0],I=A[1],D=Object(r.g)();return Object(l.useEffect)((function(){var e=function(){D.push("/glamurlshortenerapplication/links")};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[n,j,i,D]),Object(l.useEffect)((function(){a&&u.a.get("/api/url/short/clickDates/".concat(a.short)).then((function(e){var t=e.data.shortUrl.clicksDates;return g(t)})).catch((function(e){b("Something went wrong :("),console.log(e)}))}),[a,b]),Object(l.useEffect)((function(){if(f.length>0){var e={},t={},a={};f.forEach((function(n){var c=n.date,r=n.referrer,o=n.location,l=("00"+(c=new Date(c)).getDate()).slice(-2)+"/"+("00"+(c.getMonth()+1)).slice(-2)+"/"+c.getFullYear(),i=function(n,s){e[n]?e[n]=e[n]+1:e[n]=1,t[s]?t[s]=t[s]+1:t[s]=1,a[o]?a[o]=a[o]+1:a[o]=1};if(s&&d){var u=s.format("DD/MM/YYYY"),j=d.format("DD/MM/YYYY");l>=u&&l<=j&&i(l,r)}else if(s){l>=s.format("DD/MM/YYYY")&&i(l,r)}else if(d){l<=d.format("DD/MM/YYYY")&&i(l,r)}else i(l,r)}));var n=[],c=[],r=[];Object.keys(e).forEach((function(t){n.push({date:t,clicks:e[t]})})),n=n.sort(),Object.keys(t).forEach((function(e){return c.push({name:e,value:t[e]})})),Object.keys(a).forEach((function(e){r.push({country:e,value:a[e]})}));o=c,l=r,S(n),C(o),I(l)}var o,l}),[f,s,d]),Object(p.jsxs)(U.a,{title:"Clicks Stats".concat(h?"":" (Press any key to close modal)"),visible:t,footer:null,closeIcon:Object(p.jsx)(c.b,{to:"/glamurlshortenerapplication/links",children:"\u2716"}),children:[Object(p.jsxs)("div",{className:"modal-top-half",children:[Object(p.jsxs)("div",{className:"links",children:[Object(p.jsxs)("p",{children:["Short Link :"," ",Object(p.jsx)("a",{target:"_blank",rel:"noreferrer",href:window.location.href.split("glamurlshortenerapplication")[0]+(null===a||void 0===a?void 0:a.short),children:null===a||void 0===a?void 0:a.short})]}),Object(p.jsxs)("p",{children:["Long Link :"," ",Object(p.jsx)("a",{target:"_blank",rel:"noreferrer",href:null===a||void 0===a?void 0:a.full,children:(null===a||void 0===a?void 0:a.full.slice(0,h?40:50))+"..."})]})]}),Object(p.jsxs)("div",{className:"dates",children:[Object(p.jsx)(M.a,{placeholder:"Start date",onChange:i,disabledDate:function(e){return d&&e>d||e>Date.now()},value:s,style:{marginBottom:"1rem"}}),Object(p.jsx)(M.a,{placeholder:"End date",onChange:j,disabledDate:function(e){return s?e>Date.now()||e<s:e>Date.now()},value:d})]})]}),f.length>0?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{className:"modal-bottom-half",children:[Object(p.jsxs)("div",{children:[Object(p.jsx)("h3",{className:"graph-label",children:"Traffic over time"}),Object(p.jsxs)(P.a,{width:h?350:500,height:280,data:w,children:[Object(p.jsx)(Y.a,{dataKey:"date"}),Object(p.jsx)(_.a,{dataKey:"clicks"}),Object(p.jsx)(z.a,{}),Object(p.jsx)(B.a,{dataKey:"clicks",fill:"#3E3F3A"})]})]}),Object(p.jsxs)("div",{children:[Object(p.jsx)("h3",{className:"graph-label",children:"Traffic sources"}),Object(p.jsxs)(F.a,{width:400,height:250,children:[Object(p.jsx)(W.a,{data:E,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,fill:"#3E3F3A"}),Object(p.jsx)(G.a,{}),Object(p.jsx)(z.a,{})]})]})]}),Object(p.jsx)("div",{className:"modal-world-map",children:T.length>0?Object(p.jsx)(K.WorldMap,{color:"#3E3F3A",title:"Traffic sources categorized by countries",size:"xl",data:T,frame:!0}):Object(p.jsx)(R.a,{style:{marginTop:"2rem"}})})]}):Object(p.jsx)(R.a,{style:{marginTop:"2rem"}})]})},q=function(e){var t=e.isModalVisible,a=e.setIsModalVisible,n=e.modalInfo,s=e.setError,c=e.urls,r=e.setUrls,l=e.accessToken,d=e.username,b=i.a.useState(!1),h=Object(o.a)(b,2),O=h[0],m=h[1],f=i.a.useState(n?n.full:""),g=Object(o.a)(f,2),x=g[0],v=g[1];return i.a.useEffect((function(){n&&v(n.full)}),[n]),Object(p.jsx)(U.a,{title:"Edit Long URL",okText:"Save",visible:t,closeIcon:Object(p.jsx)("h2",{onClick:function(){return a(!1)},children:"\u2716"}),confirmLoading:O,onOk:function(){x.length>0&&/(([\w]+:)?\/\/)?(([\d\w]|%[a-fA-f\d]{2,2})+(:([\d\w]|%[a-fA-f\d]{2,2})+)?@)?([\d\w][-\d\w]{0,253}[\d\w]\.)+[\w]{2,63}(:[\d]+)?(\/([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)*(\?(&?([-+_~.\d\w]|%[a-fA-f\d]{2,2})=?)*)?(#([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)?/.test(x)?(m(!0),u.a.patch("/api/url/shortUrls/long",{full:x,accessToken:l,username:d,id:null===n||void 0===n?void 0:n.key}).then((function(e){if(200===e.status){var t=Object(C.a)(c);t[null===n||void 0===n?void 0:n.idx].full=x,o="Saved",j.b.success(o),r(t),m(!1),a(!1)}else s("Something went wrong! :(");var o})).catch((function(e){var t;(console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?s(e.response.data.message):s("Something went wrong! :("))}))):(s("Invalid URL entered"),m(!1),a(!1))},onCancel:function(){return a(!1)},children:Object(p.jsxs)("div",{style:{width:"90%",display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(p.jsxs)("p",{style:{fontWeight:"900",textAlign:"center"},children:["Short URL :",Object(p.jsx)("span",{style:{marginLeft:"1rem",fontWeight:"400"},children:null===n||void 0===n?void 0:n.short})]}),Object(p.jsxs)("p",{style:{fontWeight:"900",textAlign:"center"},children:["Long URL :",Object(p.jsx)("input",{value:x,onChange:function(e){return v(e.target.value)},style:{border:"none",outline:"none",marginLeft:"1rem",width:"60vw",fontWeight:"400",marginTop:"1rem"}})]})]})})},H=L.a.Option,J=function(e){j.b.success(e)},Q=function(e){var t=e.username,a=e.accessToken,n=e.setError,s=e.mobileMode,i=e.Admin,d=Object(l.useState)([{short:"asdasdasdas",full:"asdasdasdasdas",clicks:10}]),j=Object(o.a)(d,2),b=j[0],h=j[1],O=Object(l.useState)(!1),m=Object(o.a)(O,2),g=m[0],x=m[1],v=Object(l.useState)(!1),w=Object(o.a)(v,2),S=w[0],k=w[1],y=Object(l.useState)(0),U=Object(o.a)(y,2),M=U[0],R=U[1],P=Object(l.useState)([]),Y=Object(o.a)(P,2),_=Y[0],z=Y[1],B=Object(l.useState)(!1),F=Object(o.a)(B,2),W=F[0],G=F[1],K=Object(l.useState)(!1),Q=Object(o.a)(K,2),X=Q[0],Z=Q[1],$=Object(l.useState)(!1),ee=Object(o.a)($,2),te=ee[0],ae=ee[1],ne=Object(l.useState)(!1),se=Object(o.a)(ne,2),ce=se[0],re=se[1],oe=Object(l.useState)(!1),le=Object(o.a)(oe,2),ie=le[0],de=le[1],ue=Object(l.useState)(!1),je=Object(o.a)(ue,2),be=je[0],he=je[1],Oe=Object(l.useState)(!1),me=Object(o.a)(Oe,2),fe=me[0],pe=me[1],ge=Object(l.useState)(""),xe=Object(o.a)(ge,2),ve=xe[0],we=xe[1],Se=Object(l.useState)(""),ke=Object(o.a)(Se,2),ye=ke[0],Ee=ke[1],Ce=Object(l.useState)(1),Le=Object(o.a)(Ce,2),Ae=Le[0],Te=Le[1],Ie=Object(l.useState)(10),De=Object(o.a)(Ie,2),Ne=De[0],Ue=De[1],Me=Object(l.useState)("latest"),Re=Object(o.a)(Me,2),Pe=Re[0],Ye=Re[1],_e=Object(l.useState)(3),ze=Object(o.a)(_e,2),Be=ze[0],Fe=ze[1],We=Object(l.useState)(null),Ge=Object(o.a)(We,2),Ke=Ge[0],Ve=Ge[1],qe=Object(l.useState)(null),He=Object(o.a)(qe,2),Je=He[0],Qe=He[1],Xe=Object(l.useState)(null),Ze=Object(o.a)(Xe,2),$e=Ze[0],et=Ze[1],tt=Object(l.useState)(!1),at=Object(o.a)(tt,2),nt=at[0],st=at[1],ct=Object(l.useState)(!1),rt=Object(o.a)(ct,2),ot=rt[0],lt=rt[1],it=Object(l.useState)(null),dt=Object(o.a)(it,2),ut=dt[0],jt=dt[1],bt=Object(r.i)().url,ht=Object(r.h)(),Ot=ht.short,mt=ht.full,ft=[{title:"Created at",dataIndex:"createdAt",render:function(e){var t=new Date(e);return Object(p.jsx)("p",{children:("00"+(t.getMonth()+1)).slice(-2)+"/"+("00"+t.getDate()).slice(-2)+"/"+t.getFullYear()+" "+("00"+t.getHours()).slice(-2)+":"+("00"+t.getMinutes()).slice(-2)+":"+("00"+t.getSeconds()).slice(-2)})}},{title:"Short URL",dataIndex:"short",render:function(e,t){var a=t.idx;return Object(p.jsxs)("p",{children:[Object(p.jsx)("a",{target:"_blank",rel:"noreferrer",onClick:function(){var e=Object(C.a)(b);e[a]=Object(E.a)(Object(E.a)({},e[a]),{},{clicks:e[a].clicks+1}),h(e)},href:window.location.href.split("glamurlshortenerapplication")[0]+e,children:e}),Object(p.jsx)("span",{className:"copy-button-list",onClick:function(){var t=document.createElement("input");document.body.appendChild(t),t.value=window.location.href.split("glamurlshortenerapplication")[0]+e,t.select(),document.execCommand("copy",!1),t.remove(),J("Copied")},children:"Copy"})]})}},{title:"Long URL",dataIndex:"full",render:function(e,t){var a=t.idx,n=t.key,s=t.short;return Object(p.jsxs)("p",{children:[Object(p.jsx)("a",{target:"_blank",rel:"noreferrer",href:e,children:e.slice(0,50)+"..."}),Object(p.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"18px",cursor:"pointer"},onClick:function(){jt({key:n,idx:a,full:e,short:s}),lt(!0)},children:"\u270e"})]})}},{title:"Clicks",dataIndex:"clicks",render:function(e,t){var a=t.short,n=t.full;return Object(p.jsxs)(c.b,{to:"".concat(bt,"/").concat(a,"/").concat(n),children:[e," \ud83d\udcc8"]})}},{title:"Protected",dataIndex:"password",render:function(e){return e?Object(p.jsx)("p",{style:{cursor:"pointer"},onClick:function(){return k((function(e){return!e}))},children:S?e:Object(p.jsx)("span",{children:"\ud83d\udd12"})}):Object(p.jsx)("h3",{children:"-"})}},{title:"Status",dataIndex:"status",render:function(e){return e?Object(p.jsx)("p",{children:"Enabled"}):Object(p.jsx)("p",{children:"Disabled"})}}];i&&ft.splice(1,0,{title:"Created By",dataIndex:"user"}),Object(l.useEffect)((function(){Ot&&mt?(Ve({short:Ot,full:mt}),Qe(null),et(null)):(Ve(null),Qe(null),et(null))}),[Ot,mt]),Object(l.useEffect)((function(){var e=i?"/api/url/admin":"/api/url";u.a.post(e,{accessToken:a,username:t,pageNumber:Ae,search:ve,sort:Pe,filter:Be,pageSize:Ne}).then((function(e){var a=[];e.data.shortUrls.forEach((function(e,t){var n=e.short,s=e.full,c=e.clicks,r=e._id,o=e.password,l=e.createdAt,i=e.status,d=e.user;a.push({short:n,full:s,clicks:c,key:r,password:o,createdAt:l,status:i,idx:t,user:d})})),h(a);var s=i?"/api/url/admin/shortUrls/count/".concat(t):"/api/url/shortUrls/count/".concat(t);u.a.get(s).then((function(e){var t=e.data.count;return R(t)})).catch((function(e){var t;(console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?n(e.response.data.message):n("Something went wrong! :("))}))})).catch((function(e){var t;(console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?n(e.response.data.message):n("Something went wrong! :("))}))}),[t,a,n,Ae,ve,Be,Pe,g,Ne,i]),Object(l.useEffect)((function(){var e=setTimeout((function(){we(ye),Te(1)}),1e3);return function(){return clearTimeout(e)}}),[ye]),Object(l.useEffect)((function(){st(!!Ke)}),[Ke]);var pt=function(e){de(!0),e?(he(!0),re(!0)):(pe(!0),ae(!0));var s=[];_.forEach((function(t){b.find((function(e){return e.key===t})).status!==e&&s.push(t)})),u.a.patch("/api/url/shortUrls",{accessToken:a,username:t,ids:s,status:e}).then((function(){J(e?"Enabled":"Disabled"),ae(!1),de(!1),z([]),e?(he(!1),re(!1)):(pe(!1),ae(!1));var t=Object(C.a)(b);t=t.map((function(t){return s.some((function(e){return t.key===e}))?Object(E.a)(Object(E.a)({},t),{},{status:e}):t})),h(t)})).catch((function(t){var a;(z([]),ae(!1),de(!1),e?(he(!1),re(!1)):(pe(!1),ae(!1)),console.log(t),t.response)&&((null===(a=t.response.data)||void 0===a?void 0:a.message)?n(t.response.data.message):n("Something went wrong! :("))}))},gt={selectedRows:_,onChange:function(e){return z(e)}},xt=_.length>0;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(V,{isModalVisible:nt,modalInfo:Ke,setModalInfo:Ve,modalStartDate:Je,setModalStartDate:Qe,modalEndDate:$e,setModalEndDate:et,setError:n,mobileMode:s,Admin:i}),Object(p.jsx)(q,{isModalVisible:ot,setIsModalVisible:lt,modalInfo:ut,setError:n,urls:b,setUrls:h,accessToken:a,username:t}),Object(p.jsxs)("div",{className:"list-container",children:[Object(p.jsxs)("p",{children:["Table of links generated by ",i?"others":"you"]}),Object(p.jsxs)("div",{children:[Object(p.jsxs)("div",{style:{marginBottom:"1rem"},children:[Object(p.jsx)(A.a,{title:"Are you sure to delete selected URLs?",onCancel:function(){G(!0),he(!0),pe(!0);var e=[];_.forEach((function(t){e.push(t)})),u.a.delete("/api/url/shortUrls",{data:{accessToken:a,username:t,ids:e}}).then((function(){J("Deleted"),G(!1),he(!1),pe(!1),Te(1),z([]),x((function(e){return!e}))})).catch((function(e){var t;(z([]),G(!1),he(!1),pe(!1),x((function(e){return!e})),console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?n(e.response.data.message):n("Something went wrong! :("))}))},okText:"Cancel",cancelText:"Delete",children:Object(p.jsx)(f.a,{style:{marginRight:"0.5rem"},type:"danger",disabled:!xt||ie,loading:W,children:"Delete"})}),"  ",Object(p.jsx)(A.a,{title:"Are you sure to disable selected URLs?",onCancel:function(){return pt(!1)},okText:"Cancel",cancelText:"Disable",children:Object(p.jsx)(f.a,{style:{marginLeft:"0.5rem",marginRight:"0.5rem"},type:"danger",disabled:!xt||be,loading:te,children:"Disable"})}),"  ",Object(p.jsx)(A.a,{title:"Are you sure to enable selected URLs?",onCancel:function(){return pt(!0)},okText:"Cancel",cancelText:"Enable",children:Object(p.jsx)(f.a,{style:{marginLeft:"0.5rem"},type:"primary",disabled:!xt||fe,loading:ce,children:"Enable"})}),Object(p.jsx)("span",{style:{marginLeft:8,position:"relative",top:"5px"},children:xt?"Selected ".concat(_.length," items"):""})]}),Object(p.jsx)("div",{children:Object(p.jsx)(T.a,{placeholder:"Search....",value:ye,onChange:function(e){return Ee(e.target.value)}})}),Object(p.jsxs)("div",{children:[Object(p.jsx)(I.a,{title:"Sort by",children:Object(p.jsxs)(L.a,{value:Pe,onChange:function(e){Te(1),Ye(e)},children:[Object(p.jsx)(H,{value:"latest",children:"Latest"}),Object(p.jsx)(H,{value:"oldest",children:"Oldest"}),Object(p.jsx)(H,{value:"mostclicked",children:"Most clicked"}),Object(p.jsx)(H,{value:"leastclicked",children:"Least clicked"})]})}),Object(p.jsx)(I.a,{title:"Link enabled/disabled filter",children:Object(p.jsxs)(D.a.Group,{onChange:function(e){Te(1),Fe(e.target.value)},value:Be,children:[Object(p.jsx)(D.a,{value:1,children:"Enabled"}),Object(p.jsx)(D.a,{value:2,children:"Disabled"}),Object(p.jsx)(D.a,{value:3,children:"Both"})]})})]})]}),Object(p.jsx)(N.a,{rowSelection:gt,columns:ft,dataSource:b,scroll:{x:1e3},pagination:{current:Ae,total:M,onChange:Te,position:["topRight"],onShowSizeChange:Ue}}),M>0?Object(p.jsx)(A.a,{title:"Are you sure to delete all URLs generated by you?",onCancel:function(){Z(!0);var e=i?"/api/url/admin/shortUrls/all":"/api/url/shortUrls/all";u.a.delete(e,{data:{accessToken:a,username:t}}).then((function(){h([]),R(0),G(!1),Te(1),x((function(e){return!e}))})).catch((function(e){var t;(Z(!1),console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?n(e.response.data.message):n("Something went wrong! :("))}))},okText:"Cancel",cancelText:"Delete",children:Object(p.jsxs)(f.a,{style:{margin:"1rem 0"},type:"danger",loading:X,children:["Delete all ",M," links generated by"," ",i?"other users":"you"]})}):null]})]})},X={appId:"d4da2439-fc78-49c7-a5d8-b3288224a42d",redirectUri:window.location.href.split("glamurlshortenerapplication")[0],scopes:["user.read"],authority:"https://login.microsoftonline.com/".concat("7c87cabd-9999-4fe8-84b5-a3092b16040e")},Z=Object(r.j)((function(e){var t=e.location,a=null,n=Object(l.useState)("home"),s=Object(o.a)(n,2),i=s[0],d=s[1],O=Object(l.useState)(!1),f=Object(o.a)(O,2),x=f[0],v=f[1],w=Object(l.useState)(!1),S=Object(o.a)(w,2),k=S[0],E=S[1],C=Object(l.useState)(!1),L=Object(o.a)(C,2),A=L[0],T=L[1],I=Object(l.useState)(!1),D=Object(o.a)(I,2),N=D[0],U=D[1],M=Object(l.useState)(null),R=Object(o.a)(M,2),P=R[0],Y=R[1],_=Object(l.useState)(null),z=Object(o.a)(_,2),B=z[0],F=z[1],W=Object(l.useState)(null),G=Object(o.a)(W,2),K=G[0],V=G[1],q=Object(l.useState)(null),H=Object(o.a)(q,2),J=H[0],Z=H[1],$=Object(l.useState)(null),ee=Object(o.a)($,2),te=ee[0],ae=ee[1],ne=Object(r.i)(),se=ne.path,ce=ne.url,re=Object(r.g)();Object(l.useEffect)((function(){var e=t.pathname.split("/");2===e.length?d("home"):"about"===e[2]?d("about"):"links"===e[2]?d("links"):"admin"===e[2]?d("admin"):d("home")}),[t]),Object(l.useEffect)((function(){localStorage.getItem("redirect")?t.pathname.length>28&&localStorage.setItem("redirect",t.pathname):localStorage.setItem("redirect",t.pathname),window.innerWidth<768?U(!0):U(!1);var e=window.addEventListener("resize",(function(){window.innerWidth<768?U(!0):U(!1)})),a=localStorage.getItem("accesstoken"),n=localStorage.getItem("username"),s=localStorage.getItem("name");return a&&n&&s&&!k&&u.a.post("/api/authenticate",{accessToken:a,username:n}).then((function(e){if(200===e.status){v(!0),e.data.admin&&T(!0),Y(s),F(a),V(n),E(!0);var t=localStorage.getItem("redirect");t&&(re.push(t),localStorage.removeItem("redirect"))}else Z("Something went wrong! :(")})).catch((function(e){var t,a;e.response&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?Z(e.response.data.message):e.response&&((null===(a=e.response.data)||void 0===a?void 0:a.message)?Z(e.response.data.message):Z("Something went wrong! :(")));console.log(e)})),function(){window.removeEventListener("resize",e)}}),[x,t,k,re]),Object(l.useEffect)((function(){var e;J&&(e=J,j.b.error(e),Z(null))}),[J]);var oe=new h.a({auth:{clientId:X.appId,redirectUri:X.redirectUri,authority:X.authority}}),le=function(){try{oe.logoutPopup().then((function(){localStorage.removeItem("name"),localStorage.removeItem("accesstoken"),localStorage.removeItem("username"),localStorage.removeItem("redirect"),clearTimeout(a),Y(null),v(!1),E(!1),T(!1),F(null),V(null),ae(null),d("home")}))}catch(t){var e;if(console.log(t),t.response)(null===(e=t.response.data)||void 0===e?void 0:e.message)?Z(t.response.data.message):Z("Something went wrong! :(")}};return Object(p.jsx)("div",{children:Object(p.jsxs)("div",{children:[Object(p.jsx)(g,{user:P,authenticated:x,login:function(){try{oe.loginPopup({scopes:X.scopes,prompt:"select_account"}).then((function(e){a=setTimeout(le,3599998),localStorage.setItem("name",e.account.name),localStorage.setItem("username",e.account.username),localStorage.setItem("accesstoken",e.accessToken),v(!0)}))}catch(t){var e;if(console.log(t),t.response)(null===(e=t.response.data)||void 0===e?void 0:e.message)?Z(t.response.data.message):Z("Something went wrong! :(")}},logout:le}),Object(p.jsx)("div",{className:"menu-container",children:Object(p.jsxs)(b.a,{onClick:function(e){return d(e.key)},selectedKeys:[i],mode:"horizontal",style:{justifyContent:"center",width:"100%"},theme:"dark",children:[Object(p.jsx)(b.a.Item,{children:Object(p.jsx)(c.b,{to:ce,children:"Home"})},"home"),Object(p.jsx)(b.a.Item,{children:Object(p.jsx)(c.b,{to:"".concat(ce,"/about"),children:"About"})},"about"),x?Object(p.jsx)(b.a.Item,{children:Object(p.jsx)(c.b,{to:"".concat(ce,"/links"),children:"Links"})},"links"):null,A?Object(p.jsx)(b.a.Item,{children:Object(p.jsx)(c.b,{to:"".concat(ce,"/admin"),children:"Admin"})},"admin"):null]})}),Object(p.jsxs)(r.d,{children:[Object(p.jsx)(r.b,{exact:!0,path:se,children:Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(y,{authenticated:x,accessToken:B,username:K,setError:Z,mobileMode:N,shortURL:te,setShortURL:ae}),te?Object(p.jsx)(m.a,{className:"qr-code-app",value:te}):null]})}),Object(p.jsx)(r.b,{exact:!0,path:"".concat(se,"/about"),children:Object(p.jsxs)("div",{className:"app-about",children:["GLAM URL shortener is a minimalistic link shortening platform built specifically for Oxford GLAM by",Object(p.jsxs)("a",{target:"_blank",rel:"noreferrer",href:"https://www.cloudmantra.net",children:[" cloudmantra.net",Object(p.jsx)("sup",{children:"TM"})]})]})}),Object(p.jsx)(r.b,{path:"".concat(se,"/links/:short?/:full?"),children:x?Object(p.jsx)(Q,{accessToken:B,username:K,setError:Z,mobileMode:N}):Object(p.jsx)(r.a,{to:se})}),Object(p.jsx)(r.b,{path:"".concat(se,"/admin/:short?/:full?"),children:x?A?Object(p.jsx)(Q,{accessToken:B,username:K,setError:Z,mobileMode:N,Admin:!0}):Object(p.jsx)(r.a,{to:"".concat(se,"/links")}):Object(p.jsx)(r.a,{to:se})})]})]})})})),$=function(){var e=Object(l.useState)("Redirecting..."),t=Object(o.a)(e,2),a=t[0],n=t[1],s=Object(l.useState)(!1),c=Object(o.a)(s,2),r=c[0],i=c[1],d=Object(l.useState)(""),j=Object(o.a)(d,2),b=j[0],h=j[1];Object(l.useEffect)((function(){u.a.get("/api/url/short/".concat(window.location.pathname.slice(1),"?referrer=").concat(document.referrer)).then((function(e){var t=e.data.shortUrl;"string"===typeof t&&"password protected"===t?i(!0):"string"===typeof t&&"disabled"===t?n("Link Disabled"):window.location.href=t.full})).catch((function(e){var t;(console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?n(e.response.data.message):n("Something went wrong! :("))}))}),[]);var O=function(e){var t=function(){u()({method:"POST",url:"/api/url/short/".concat(window.location.pathname.slice(1),"?referrer=").concat(document.referrer),data:{password:b}}).then((function(e){var t=e.data.shortUrl;window.location.href=t.full})).catch((function(e){var t;(console.log(e),e.response)&&((null===(t=e.response.data)||void 0===t?void 0:t.message)?n(e.response.data.message):n("Something went wrong! :("))}))};"Enter"===e.key?t():e.key||t()};return Object(p.jsxs)("div",{style:{width:"100vw",height:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[Object(p.jsx)("p",{style:{fontSize:"5vw",marginBottom:"2rem",color:"white",width:"90vw",height:"100px",backgroundColor:"rgb(62, 63, 58)",display:"flex",justifyContent:"center",alignItems:"center"},children:"GLAM URL Shortener"}),Object(p.jsx)("h1",{style:{marginBottom:"2rem",color:"rgb(62, 63, 58)"},children:a}),r?Object(p.jsxs)("div",{style:{display:"flex"},children:[Object(p.jsx)("input",{style:{padding:"1rem 2rem",textAlign:"center",fontSize:"1rem"},placeholder:"Enter Password",value:b,onChange:function(e){var t=e.target.value;return h(t)},onKeyPress:O}),Object(p.jsx)("span",{style:{marginLeft:"1rem",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center"},onClick:O,children:"Go"})]}):null]})};s.a.render(Object(p.jsx)(c.a,{children:Object(p.jsxs)(r.d,{children:[Object(p.jsx)(r.b,{exact:!0,path:"/",children:Object(p.jsx)(r.a,{to:"/glamurlshortenerapplication"})}),Object(p.jsx)(r.b,{path:"/glamurlshortenerapplication",component:Z}),Object(p.jsx)(r.b,{path:"/:shortUrl",component:$})]})}),document.getElementById("root"))}},[[496,1,2]]]);
//# sourceMappingURL=main.c86355db.chunk.js.map